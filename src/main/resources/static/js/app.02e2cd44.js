(function(e){function t(t){for(var o,i,l=t[0],r=t[1],c=t[2],d=0,u=[];d<l.length;d++)i=l[d],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&u.push(s[i][0]),s[i]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);p&&p(t);while(u.length)u.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],o=!0,i=1;i<a.length;i++){var l=a[i];0!==s[l]&&(o=!1)}o&&(n.splice(t--,1),e=r(r.s=a[0]))}return e}var o={},i={app:0},s={app:0},n=[];function l(e){return r.p+"js/"+({}[e]||e)+"."+{"chunk-00ccb4d0":"e6f995b9","chunk-346b7dc1":"18961e45","chunk-59617df1":"c759c27b","chunk-5ab3efac":"0b4e7107","chunk-5dc3b95d":"a4aaf8a9","chunk-6f24c98f":"272eeb2a","chunk-a928cb80":"75218f11","chunk-c2bef06c":"4e53195d","chunk-ce301f42":"f0df1f83","chunk-ec35c90a":"44abd9b4"}[e]+".js"}function r(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.e=function(e){var t=[],a={"chunk-00ccb4d0":1,"chunk-346b7dc1":1,"chunk-59617df1":1,"chunk-5ab3efac":1,"chunk-5dc3b95d":1,"chunk-6f24c98f":1,"chunk-a928cb80":1,"chunk-c2bef06c":1,"chunk-ce301f42":1,"chunk-ec35c90a":1};i[e]?t.push(i[e]):0!==i[e]&&a[e]&&t.push(i[e]=new Promise((function(t,a){for(var o="css/"+({}[e]||e)+"."+{"chunk-00ccb4d0":"ecd03095","chunk-346b7dc1":"8036eae2","chunk-59617df1":"5b4d7132","chunk-5ab3efac":"f3d29b1a","chunk-5dc3b95d":"dfe6dcbb","chunk-6f24c98f":"5bb68e49","chunk-a928cb80":"ad749bf0","chunk-c2bef06c":"1ecdafd8","chunk-ce301f42":"004a5ad9","chunk-ec35c90a":"a8bc17ae"}[e]+".css",s=r.p+o,n=document.getElementsByTagName("link"),l=0;l<n.length;l++){var c=n[l],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===o||d===s))return t()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){c=u[l],d=c.getAttribute("data-href");if(d===o||d===s)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var o=t&&t.target&&t.target.src||s,n=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");n.code="CSS_CHUNK_LOAD_FAILED",n.request=o,delete i[e],p.parentNode.removeChild(p),a(n)},p.href=s;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){i[e]=0})));var o=s[e];if(0!==o)if(o)t.push(o[2]);else{var n=new Promise((function(t,a){o=s[e]=[t,a]}));t.push(o[2]=n);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,r.nc&&d.setAttribute("nonce",r.nc),d.src=l(e);var u=new Error;c=function(t){d.onerror=d.onload=null,clearTimeout(p);var a=s[e];if(0!==a){if(a){var o=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",u.name="ChunkLoadError",u.type=o,u.request=i,a[1](u)}s[e]=void 0}};var p=setTimeout((function(){c({type:"timeout",target:d})}),12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(t)},r.m=e,r.c=o,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var p=d;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0934":function(e,t,a){},"0f3a":function(e,t,a){"use strict";var o=a("3c6e"),i=a.n(o);i.a},"118b":function(e,t,a){"use strict";var o=a("f0c3"),i=a.n(o);i.a},1640:function(e,t,a){"use strict";var o=a("d761"),i=a.n(o);i.a},"1f75":function(e,t,a){"use strict";a("dbb3"),a("ecb4"),a("9302"),a("e18c"),a("e35a"),a("1458"),a("0d7a");var o=a("80a0"),i=a("82ae"),s=a.n(i),n=a("1cfa"),l=a.n(n),r=a("a18c"),c=a("a3c5"),d={UNKNOWN_ERROR:-1,UNAUTHORIZED:-11,UNKNOW_USERNAME:-12,INCORRECT_PASSWORD:-13,PERMISSION_DENIED:-3},u=a("a336"),p=a.n(u);s.a.defaults.timeout=2e4,s.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",s.a.interceptors.response.use((function(e){var t=r["a"].currentRoute.path;if(200==e.status){var a=e.data;if(a.code==d.UNAUTHORIZED){if(!t.endsWith("/login")){var o=["admin","store","delivery"],i=t.split("/").filter((function(e){return e})).shift();o.indexOf(i)<0?p()(window).trigger("show-login"):r["a"].push({path:"/"+[i,"login"].filter((function(e){return e})).join("/"),query:{from:t}})}}else a.code==d.PERMISSION_DENIED&&Object(c["Message"])({message:"权限不足，请检查登录账号或注销重新登录",type:"warning"})}return e}),(function(e){return Promise.reject(e)}));var f=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,n){s.a.get(e,Object(o["a"])({params:t},a)).then((function(e){i(e.data)}))["catch"]((function(e){n(e.data)}))}))},m=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return"string"!==typeof t&&(t=l.a.stringify(t,{arrayFormat:"repeat"})),new Promise((function(o,i){s.a.post(e,t,a).then((function(e){o(e.data)}))["catch"]((function(e){i(e.data)}))}))};t["a"]={get:f,post:m}},2204:function(e,t,a){},2217:function(e,t,a){},2681:function(e,t,a){},"293e":function(e,t,a){"use strict";var o=a("2217"),i=a.n(o);i.a},"3c6e":function(e,t,a){},4221:function(e,t,a){"use strict";var o=a("7b2f"),i=a.n(o);i.a},"4a63":function(e,t,a){"use strict";var o=a("e858"),i=a.n(o);i.a},"554d":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);var o=a("e24e"),i=a("5c62"),s=(a("a133"),a("ed0d"),a("f09c"),a("e117"),a("0261")),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},l=[],r=a("4023"),c={},d=Object(r["a"])(c,n,l,!1,null,null,null),u=d.exports,p=a("a18c"),f=a("a3c5"),m=a.n(f),g=(a("b9b6"),a("5aff"),a("554d"),a("a336")),b=a.n(g),h=(a("6ebc"),b.a.prototype.scrollbar);b.a.prototype.scrollbar=function(){h.apply(this,arguments),this.each((function(e,t){var a,s=b()(t),n=Object(i["a"])(t.attributes),l=Object(o["a"])(n);try{for(l.s();!(a=l.n()).done;){var r=a.value;if(/^data-v-/.test(r.nodeName)){s.parent().attr(r.nodeName,"");break}}}catch(c){l.e(c)}finally{l.f()}}))},s["default"].use(m.a),s["default"].config.productionTip=!1,s["default"].prototype.$=s["default"].prototype.jQuery=b.a,new s["default"]({router:p["a"],render:function(e){return e(u)}}).$mount("#app")},"6b1a":function(e,t,a){"use strict";var o=a("712f"),i=a.n(o);i.a},"6dde":function(e,t,a){"use strict";var o=a("0934"),i=a.n(o);i.a},"712f":function(e,t,a){},"7b2f":function(e,t,a){},"821e":function(e,t,a){},"86b2":function(e,t,a){},"8dec":function(e,t,a){},"8e43":function(e,t,a){"use strict";var o=a("a51f"),i=a.n(o);i.a},"959e":function(e,t,a){"use strict";var o=a("eac7"),i=a.n(o);i.a},9954:function(e,t,a){},a18c:function(e,t,a){"use strict";a("e18c");var o=a("0261"),i=a("1bee"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"fix-top-bar"},[a("div",{staticClass:"center-box"},[a("div",{staticClass:"right-part-list"},[e.userInfo.username?a("span",{staticClass:"user-info"},[a("el-dropdown",{staticClass:"cbutton"},[a("span",{staticClass:"person-center-button"},[e._v("我的")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("el-divider",{attrs:{"content-position":"center"}},[e._v(e._s(e.userInfo.nickname))])],1),a("el-dropdown-item",{attrs:{icon:"el-icon-check"}},[a("router-link",{staticStyle:{color:"#666","text-decoration":"none"},attrs:{to:"/personCenter"}},[e._v("个人中心")])],1),a("el-dropdown-item",{attrs:{icon:"el-icon-circle-check"},nativeOn:{click:function(t){return e.logout(t)}}},[e._v("退出")])],1)],1)],1):a("span",{staticClass:"cbutton login-button",on:{click:e.showLogin}},[e._v("登录")]),a("span",{staticClass:"cbutton"},[a("router-link",{staticStyle:{"text-decoration":"none",color:"#333"},attrs:{to:"/"}},[e._v("首页")])],1),a("span",{staticClass:"cbutton"},[a("el-dropdown",{staticClass:"cbutton"},[a("span",{staticClass:"person-center-button"},[e._v("后台登录")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("router-link",{staticClass:"alink",attrs:{to:"/store/login"}},[e._v("商家登录")])],1),a("el-dropdown-item",[a("router-link",{staticClass:"alink",attrs:{to:"/admin/login"}},[e._v("管理员登录")])],1),a("el-dropdown-item",[a("router-link",{staticClass:"alink",attrs:{to:"/delivery/login"}},[e._v("配送员登录")])],1)],1)],1)],1),a("span",{staticClass:"cbutton store-apply-button",on:{click:function(t){e.dialog.storeRequestVisible=!0}}},[e._v("商家入驻")]),a("el-badge",{staticClass:"item",attrs:{value:e.cartSum}},[a("span",{staticClass:"cbutton shopping-cart-button",on:{click:function(t){e.shoppingCartVisible=!0}}},[e._v("购物车")])])],1)])]),a("div",{staticClass:"top-bar-offset"}),a("router-view",{attrs:{cart:e.cartList},on:{"cart-change":e.cartChangeAction}}),a("el-dialog",{attrs:{width:"400px",visible:e.dialog.loginDialogVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"loginDialogVisible",t)}}},[a("el-tabs",{attrs:{type:"card"},model:{value:e.loginDialogTab,callback:function(t){e.loginDialogTab=t},expression:"loginDialogTab"}},[a("el-tab-pane",{attrs:{label:"登录",name:"login"}},[a("el-form",{ref:"loginForm",attrs:{model:e.dialog.user,rules:e.dialog.rules}},[a("el-form-item",{attrs:{prop:"username"}},[a("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入注册的手机号码或邮箱",autocomplete:"off"},model:{value:e.dialog.user.username,callback:function(t){e.$set(e.dialog.user,"username",t)},expression:"dialog.user.username"}})],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{"prefix-icon":"el-icon-key","show-password":"",placeholder:"请输入密码",autocomplete:"off"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loginAction(t)}},model:{value:e.dialog.user.password,callback:function(t){e.$set(e.dialog.user,"password",t)},expression:"dialog.user.password"}})],1),a("el-form-item",[a("el-button",{staticClass:"login-action-button",attrs:{type:"primary"},on:{click:e.loginAction}},[e._v("立即登录")])],1)],1)],1),a("el-tab-pane",{attrs:{label:"注册",name:"register"}},[a("el-form",{ref:"regForm",attrs:{model:e.dialog.reg,rules:e.dialog.rules}},[a("el-form-item",{attrs:{prop:"username",label:"邮箱","label-width":"80px"}},[a("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入邮箱",autocomplete:"off"},model:{value:e.dialog.reg.username,callback:function(t){e.$set(e.dialog.reg,"username",t)},expression:"dialog.reg.username"}})],1),a("el-form-item",{attrs:{prop:"nickname",label:"昵称","label-width":"80px"}},[a("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入昵称",autocomplete:"off"},model:{value:e.dialog.reg.nickname,callback:function(t){e.$set(e.dialog.reg,"nickname",t)},expression:"dialog.reg.nickname"}})],1),a("el-form-item",{attrs:{prop:"code",label:"验证码","label-width":"80px"}},[a("el-input",{attrs:{placeholder:"请输入验证码",autocomplete:"off"},model:{value:e.dialog.reg.code,callback:function(t){e.$set(e.dialog.reg,"code",t)},expression:"dialog.reg.code"}}),a("el-button",{staticClass:"get-code-button",attrs:{plain:"",disabled:e.dialog.cooling>0}},[e.dialog.cooling<=0?a("span",{on:{click:e.getCode}},[e._v("获取验证码")]):a("span",[e._v(e._s(e.dialog.cooling)+"s后重试")])])],1),a("el-form-item",{attrs:{prop:"password",label:"密码","label-width":"80px"}},[a("el-input",{attrs:{"prefix-icon":"el-icon-key","show-password":"",placeholder:"请输入密码",autocomplete:"off"},model:{value:e.dialog.reg.password,callback:function(t){e.$set(e.dialog.reg,"password",t)},expression:"dialog.reg.password"}})],1),a("el-form-item",{attrs:{prop:"phone",label:"手机","label-width":"80px"}},[a("el-input",{attrs:{placeholder:"请输入手机号码",autocomplete:"off"},model:{value:e.dialog.reg.phone,callback:function(t){e.$set(e.dialog.reg,"phone",t)},expression:"dialog.reg.phone"}})],1),a("el-form-item",[a("el-button",{staticClass:"login-action-button",attrs:{type:"primary"},on:{click:e.registerAction}},[e._v("立即注册")])],1)],1)],1)],1)],1),a("el-dialog",{attrs:{title:"申请商家入驻",visible:e.dialog.storeRequestVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"storeRequestVisible",t)}}},[a("el-form",{ref:"storeRequestForm",attrs:{model:e.dialog.newStore,rules:e.dialog.requestRules}},[a("el-form-item",{attrs:{label:"您的姓名","label-width":"120px",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入您的姓名",autocomplete:"off"},model:{value:e.dialog.newStore.name,callback:function(t){e.$set(e.dialog.newStore,"name",t)},expression:"dialog.newStore.name"}})],1),a("el-form-item",{attrs:{label:"店铺名称","label-width":"120px",prop:"storeName"}},[a("el-input",{attrs:{placeholder:"请输入店铺名称",autocomplete:"off"},model:{value:e.dialog.newStore.storeName,callback:function(t){e.$set(e.dialog.newStore,"storeName",t)},expression:"dialog.newStore.storeName"}})],1),a("el-form-item",{attrs:{label:"店铺地址","label-width":"120px",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入店铺地址",autocomplete:"off"},model:{value:e.dialog.newStore.address,callback:function(t){e.$set(e.dialog.newStore,"address",t)},expression:"dialog.newStore.address"}})],1),a("el-form-item",{attrs:{label:"联系方式","label-width":"120px",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入联系方式",autocomplete:"off"},model:{value:e.dialog.newStore.phone,callback:function(t){e.$set(e.dialog.newStore,"phone",t)},expression:"dialog.newStore.phone"}})],1),a("el-form-item",{attrs:{label:"店铺描述","label-width":"120px",prop:"description"}},[a("el-input",{attrs:{placeholder:"请输入店铺描述",autocomplete:"off"},model:{value:e.dialog.newStore.description,callback:function(t){e.$set(e.dialog.newStore,"description",t)},expression:"dialog.newStore.description"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.storeRequestVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.storeRequest()}}},[e._v("确 定")])],1)],1),a("el-drawer",{attrs:{title:"购物车!",visible:e.shoppingCartVisible,direction:"rtl",size:"50%"},on:{"update:visible":function(t){e.shoppingCartVisible=t}}},[e.storeCart&&"{}"!=JSON.stringify(e.storeCart)?e._e():a("el-card",[a("div",[e._v("购物车是空的，去逛逛吧~")])]),e._l(e.storeCart,(function(t,o){return a("el-card",{key:o,staticClass:"box-card"},[a("div",{staticClass:"cart-store",attrs:{slot:"header"},slot:"header"},[e.storeMap[o]?a("el-image",{staticStyle:{width:"30px",height:"30px"},attrs:{fit:"fit",src:e.storeMap[o].logo}}):a("el-image",{attrs:{fit:"fit"}}),e.storeMap[o]?a("span",{staticClass:"store-name"},[e._v(e._s(e.storeMap[o].storeName))]):e._e()],1),e._l(t,(function(t){return a("div",{key:t.productId,staticClass:"product-info-item"},[e.productMap[t.productId]?[a("span",{staticClass:"left-image",on:{click:function(e){e.stopPropagation()}}},[a("el-image",{staticClass:"limg",attrs:{fit:"fill",src:e.productMap[t.productId].imgUrl,"preview-src-list":[e.productMap[t.productId].imgUrl]}})],1),a("span",{staticClass:"right-introduce"},[a("div",{staticClass:"store-name"},[e._v(" "+e._s(e.productMap[t.productId].productName)+" ")]),a("div",{staticClass:"store-meta"},[a("span",{staticClass:"min-cost smw"},[e._v("库存"+e._s(e.productMap[t.productId].stock))]),a("span",{staticClass:"post-fee smw red-word"},[e._v("¥"+e._s(e.productMap[t.productId].price))])]),a("div",{staticClass:"store-intro",attrs:{title:e.productMap[t.productId].description}},[e._v(" "+e._s(e.productMap[t.productId].description)+" ")]),a("div",{staticClass:"tools-div"},[a("el-button",{attrs:{type:"warning",icon:"el-icon-minus",size:"mini",circle:""},on:{click:function(a){return e.setCart(o,t.productId,-1)}}}),a("span",{staticClass:"buy-num",staticStyle:{margin:"0 10px"}},[e._v(e._s(t.count))]),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",circle:""},on:{click:function(a){return e.setCart(o,t.productId,1,e.productMap[t.productId].stock)}}})],1)])]:e._e()],2)})),a("div",[e._v(" 共"+e._s(e.OneStoreCount[o].totalNum)+"件商品,总计¥"+e._s(e.OneStoreCount[o].totalAmount)+" ")])],2)})),e.storeCart&&"{}"!=JSON.stringify(e.storeCart)?a("div",{staticClass:"confirm-button"},[a("el-button",{staticClass:"confirm-btn",attrs:{type:"primary"},on:{click:function(t){e.addressDrawerVisible=!0}}},[e._v("立即结算")]),a("el-button",{staticClass:"cancel-btn",attrs:{type:"warning"},on:{click:e.clearCart}},[e._v("清空")])],1):e._e(),a("address-drawer",{attrs:{visible:e.addressDrawerVisible},on:{select:e.submitOrder,change:e.addressDrawerChange}})],2),e._m(0)],1)},n=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"footer-div"},[a("div",{staticClass:"text-center"},[e._v("©Copyright 2020")])])}],l=(a("dbb3"),a("fe59"),a("2eeb"),a("ea69"),a("053b"),a("08ba"),a("1fb3"),a("80a0")),r=a("1f75"),c=a("a336"),d=a.n(c),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{attrs:{title:"选择收货地址","append-to-body":!0,visible:e.isVisible,size:"75%"},on:{"update:visible":function(t){e.isVisible=t}}},[a("div",{staticClass:"out-box"},[a("div",{staticClass:"mb10"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.showAddAddress}},[e._v("新增地址")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{label:"记录 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"收货人",prop:"name"}}),a("el-table-column",{attrs:{label:"收货地址",prop:"address"}}),a("el-table-column",{attrs:{label:"联系方式",prop:"phone"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"updateTime"}}),a("el-table-column",{attrs:{label:"操作",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){return e.selectAddress(t.$index)}}},[e._v("选用")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.showEditAddress(t.$index)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.deleteAddress(t.$index)}}},[e._v("删除")])]}}])})],1)],1),a("el-dialog",{attrs:{title:"添加地址",visible:e.dialog.addAddressVisible,"append-to-body":!0,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"addAddressVisible",t)}}},[a("el-form",{ref:"addAddressForm",attrs:{model:e.dialog.newAddress,rules:e.rules}},[a("el-form-item",{attrs:{label:"收货人","label-width":"120px",prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入收货人"},model:{value:e.dialog.newAddress.name,callback:function(t){e.$set(e.dialog.newAddress,"name",t)},expression:"dialog.newAddress.name"}})],1),a("el-form-item",{attrs:{label:"收货地址","label-width":"120px",prop:"address"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入收货地址"},model:{value:e.dialog.newAddress.address,callback:function(t){e.$set(e.dialog.newAddress,"address",t)},expression:"dialog.newAddress.address"}})],1),a("el-form-item",{attrs:{label:"联系方式","label-width":"120px",prop:"phone"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入联系方式"},model:{value:e.dialog.newAddress.phone,callback:function(t){e.$set(e.dialog.newAddress,"phone",t)},expression:"dialog.newAddress.phone"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.addAddressVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialog.addAddressVisible=!1,e.addAddress()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑地址",visible:e.dialog.editAddressVisible,"append-to-body":!0,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"editAddressVisible",t)}}},[a("el-form",{ref:"editAddressForm",attrs:{model:e.dialog.editAddress,rules:e.rules}},[a("el-form-item",{attrs:{label:"收货人","label-width":"120px",prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入收货人"},model:{value:e.dialog.editAddress.name,callback:function(t){e.$set(e.dialog.editAddress,"name",t)},expression:"dialog.editAddress.name"}})],1),a("el-form-item",{attrs:{label:"收货地址","label-width":"120px",prop:"address"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入收货地址"},model:{value:e.dialog.editAddress.address,callback:function(t){e.$set(e.dialog.editAddress,"address",t)},expression:"dialog.editAddress.address"}})],1),a("el-form-item",{attrs:{label:"联系方式","label-width":"120px",prop:"phone"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入联系方式"},model:{value:e.dialog.editAddress.phone,callback:function(t){e.$set(e.dialog.editAddress,"phone",t)},expression:"dialog.editAddress.phone"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.editAddressVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialog.editAddressVisible=!1,e.editAddress()}}},[e._v("确 定")])],1)],1)],1)},p=[],f={props:["visible"],watch:{visible:function(e){this.isVisible=e,e&&this.getTableData()},isVisible:function(e){this.$emit("change",e)}},data:function(){var e={name:"收货人不能为空",address:"收货地址不能为空",phone:"联系方式不能为空"},t={},a=function(a){t[a]=[{validator:function(t,o,i){o?i():i(new Error(e[a]))},trigger:"blur"}]};for(var o in e)a(o);return{isVisible:this.visible,rules:t,dialog:{addAddressVisible:!1,editAddressVisible:!1,newAddress:{name:"",address:"",phone:""},editAddress:{name:"",address:"",phone:""}},tableData:[]}},mounted:function(){this.getTableData()},methods:{getTableData:function(){var e=this;return r["a"].get("/user/address/list").then((function(t){t&&1==t.code&&(e.tableData=t.data)}))},showAddAddress:function(){this.dialog.addAddressVisible=!0},showEditAddress:function(e){this.dialog.editAddress=this.tableData[e],this.dialog.editAddressVisible=!0},selectAddress:function(e){this.$emit("select",this.tableData[e])},deleteAddress:function(e){var t=this,a=this.tableData[e].id;this.$confirm("此操作将永久删除该地址, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r["a"].post("/user/address/delete",{id:a}).then((function(e){e&&1==e.code?(t.$message({message:"删除地址成功",type:"success"}),t.getTableData()):t.$alert(e.tips,"删除地址失败",{confirmButtonText:"确定"})}))}))["catch"]((function(){t.$message({type:"info",message:"已取消删除"})}))},addAddress:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=t?this.dialog.editAddress:this.dialog.newAddress,o=t?this.$refs["editAddressForm"]:this.$refs["addAddressForm"],i=t?"编辑":"添加";o.validate((function(t){t?r["a"].post("/user/address/save",a).then((function(t){t&&1==t.code?(e.getTableData(),e.addAddressVisible=!1,e.editAddressVisible=!1,e.$message({type:"success",message:i+"地址成功"})):e.$alert(t.tips,i+"地址失败",{confirmButtonText:"确定"})})):e.$alert("信息填写有误","未提交",{confirmButtonText:"确定"})}))},editAddress:function(){this.addAddress(!0)}}},m=f,g=(a("c482"),a("4023")),b=Object(g["a"])(m,u,p,!1,null,"53e00927",null),h=b.exports,v={components:{AddressDrawer:h},data:function(){var e={};return["name","storeName","phone","address","description"].forEach((function(t){e[t]=[{validator:function(e,t,a){t?a():a(new Error("不能为空"))}}]})),{shoppingCartVisible:!1,addressDrawerVisible:!1,userInfo:{username:"",nickname:""},loginDialogTab:"login",timer:null,dialog:{cooling:0,storeRequestVisible:!1,loginDialogVisible:!1,requestRules:e,user:{username:"",password:""},newStore:{name:"",storeName:"",address:"",phone:"",description:""},reg:{username:"",password:"",code:"",nickname:"",phone:""},rules:{nickname:[{validator:function(e,t,a){t?a():a(new Error("请输入昵称"))}}],username:[{validator:function(e,t,a){t?a():a(new Error("请输入邮箱"))},trigger:"blur"}],phone:[{validator:function(e,t,a){t?a():a(new Error("请输入手机号码"))},trigger:"blur"}],password:[{validator:function(e,t,a){t?a():a(new Error("请输入密码"))},trigger:"blur"}]}},cartData:[],storeCart:{},productMap:{},storeAccountMap:{},storeMap:{},cartSum:""}},watch:{storeCart:{handler:function(e){var t=0,a=e;for(var o in a)for(var i=0;i<a[o].length;i++)t-=-a[o][i].count;(t<=0||isNaN(t))&&(t=""),this.cartSum=t},deep:!0}},computed:{cartList:function(){var e=this.$route.query.storeId;return e?this.storeCart[e]:[]},OneStoreCount:function(){var e={},t=this.storeCart,a=this.productMap,o=function(o){var i=0,s=0;t[o].forEach((function(e){i+=e.count})),t[o].forEach((function(e){a[e.productId]&&(s=a[e.productId].price*e.count+s)})),e[o]={totalNum:i,totalAmount:s}};for(var i in t)o(i);return this.storeAccountMap=e,e}},beforeRouteLeave:function(e,t,a){d()(window).off("show-login"),a()},mounted:function(){var e=this,t=function(){d()(window).on("show-login",(function(){e.dialog.loginDialogVisible=!0,e.loginDialogTab="login"}))};for(var a in this.getUserInfo().then(t)["catch"](t),this.storeCart=JSON.parse(window.localStorage.getItem("cart")||null)||{},this.storeCart)this.cartChangeAction(a,this.storeCart[a])},methods:{storeRequest:function(){var e=this;this.dialog.storeRequestVisible=!1;var t=this.dialog.newStore,a="申请商家入驻信息提交",o=this.$refs["storeRequestForm"],i=Object(l["a"])({},t);o.validate((function(t){if(!t)return e.$alert("信息填写有误","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/user/storeRequest",i).then((function(t){t&&1==t.code?(e.$message({message:a+"成功",type:"success"}),o.resetFields()):e.$alert(t.tips,a+"失败",{confirmButtonText:"确定"})}))}))},addressDrawerChange:function(e){this.addressDrawerVisible=e},submitOrder:function(e){var t=this;if(e&&e.name&&e.address&&e.phone){var a=this.storeCart,o=this.productMap,i=this.userInfo,s=[],n=function(n){var l=[];a[n].forEach((function(e){var t=e.productId;l.push({productId:t,productName:o[t].productName,productPrice:o[t].price,productQuantity:e.count,productIcon:o[t].imgUrl})}));var r={storeId:n,buyerName:e.name,buyerPhone:e.phone,buyerId:i.id,buyerAddress:e.address,orderAmount:t.storeAccountMap[n].totalAmount,orderStatus:0,orderDetailList:l};s.push(r)};for(var l in a)n(l);r["a"].post("/user/submitOrder",JSON.stringify(s),{headers:{"Content-Type":"application/json;charset=utf-8"}}).then((function(e){e&&1==e.code?(t.$message({type:"success",message:"提交订单成功"}),t.shoppingCartVisible=!1,t.addressDrawerVisible=!1,t.clearCart()):t.$alert(e.tips||"错误","提交订单失败",{confirmButtonText:"确定"})}))}else this.$alert("未选择收货地址","未提交",{confirmButtonText:"确定"})},getCode:function(){var e=this,t=this.dialog.reg.username,a=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;a.test(t)?(this.dialog.cooling=60,clearInterval(this.timer),this.timer=setInterval((function(){e.dialog.cooling--,e.dialog.cooling<=0&&clearInterval(e.timer)}),1e3),r["a"].get("/open/getCode",{email:t}).then((function(t){t&&1==t.code?e.$message({type:"success",message:"发送邮箱验证码成功，请注意查收"}):(e.dialog.cooling=0,e.$message({type:"warning",message:"获取验证码失败，请重试"}))}))):this.$message({type:"warning",message:"请输入正确的邮箱地址"})},logout:function(){var e=this;r["a"].get("/logout").then((function(){e.$router.go(0)}))},clearCart:function(){this.storeCart={},window.localStorage.removeItem("cart")},setCart:function(e,t){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=function(e){return i&&(e=e>i?i:e),e=e<0?0:e,e},n=this.storeCart[e],l=-1,r=-2;for(a=0;a<n.length;a++){var c=n[a];if(c.productId==t){l=c.count,r=c.count=s(c.count- -o);break}}a>=n.length&&n.push({productId:t,count:s(o)}),0==r&&n.splice(a,1),l!=r&&this.cartChangeAction(e,n)},cartChangeAction:function(e,t){var a=this;this.$set(this.storeCart,e,t),(!t||t.length<=0)&&delete this.storeCart[e],window.localStorage.setItem("cart",JSON.stringify(this.storeCart)),this.storeMap[e]||r["a"].post("/open/index/getStoreInfo",{storeId:e}).then((function(t){t&&1==t.code&&t.data&&(a.storeMap[e]=t.data)})),r["a"].post("/open/index/getProductInfo",{products:t.map((function(e){return e.productId})).filter((function(e){return!a.productMap[e]}))}).then((function(e){e&&1==e.code&&(a.productMap=Object(l["a"])(Object(l["a"])({},a.productMap),e.data))}))},showLogin:function(){this.dialog.loginDialogVisible=!0},getUserInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null==t||t==this.userInfo.id?r["a"].get("/open/loginStatus").then((function(t){t&&1==t.code&&(e.userInfo=t.data)})):Promise.reject()},loginAction:function(){var e=this,t=this.$refs["loginForm"];t.validate((function(t){if(!t)return e.$alert("信息填写有误","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/login",e.dialog.user).then((function(t){t&&1==t.code?(e.dialog.loginDialogVisible=!1,e.$message({message:"登录成功",type:"success",showClose:!0,onClose:function(){e.getUserInfo()}})):e.$alert(t.tips,"登录失败",{confirmButtonText:"确定"})}))}))},registerAction:function(){var e=this,t=this.$refs["regForm"];t.validate((function(t){if(!t)return e.$alert("信息填写有误","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/open/register",e.dialog.reg).then((function(t){t&&1==t.code?(e.dialog.loginDialogVisible=!1,e.$message({message:"注册成功",type:"success",showClose:!0}),e.dialog.reg={code:"",username:"",password:"",nickname:""}):t.tips&&e.$alert(t.tips,"注册失败",{confirmButtonText:"确定"})}))}))}}},y=v,I=(a("b523"),Object(g["a"])(y,s,n,!1,null,"d9a72c7a",null)),w=I.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"center-box article-box"},[a("div",{staticClass:"tools-div"},[a("span",{staticClass:"search-span"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchInfo}},[a("el-form-item",[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入关键字","prefix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchInfo()}},model:{value:e.searchInfo.keyword,callback:function(t){e.$set(e.searchInfo,"keyword",t)},expression:"searchInfo.keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{plain:"",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getSearchInfo()}}},[e._v("搜索")])],1)],1)],1)]),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:16}},[a("div",{staticClass:"grid-content store-list-box"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("店铺列表")])]),e._l(e.tableInfo.tableData,(function(t,o){return a("div",{key:t.id,staticClass:"store-info-item",attrs:{"data-index":o},on:{click:function(a){return e.goStore(t)}}},[a("span",{staticClass:"left-image",on:{click:function(e){e.stopPropagation()}}},[a("el-image",{staticClass:"limg",attrs:{fit:"fill",src:t.logo,"preview-src-list":[t.logo]}})],1),a("span",{staticClass:"right-introduce"},[a("div",{staticClass:"store-name"},[e._v(e._s(t.storeName))]),a("div",{staticClass:"store-address"},[e._v(e._s(t.address))]),a("div",{staticClass:"store-meta"},[a("span",{staticClass:"min-cost smw"},[e._v("¥"+e._s(t.minCost)+"起送")]),a("span",{staticClass:"post-fee smw"},[e._v("配送费¥"+e._s(t.postFee))])]),a("div",{staticClass:"store-intro"},[e._v(e._s(t.description))])])])})),a("el-pagination",{attrs:{"current-page":e.tableInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.tableInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.tableInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changePageSize,"current-change":e.changePage}})],2)],1)]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content recommend-box"},[a("el-card",{staticClass:"box-card",attrs:{"body-style":{padding:"10px"}}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("推荐好物")])]),e._l(e.recommends,(function(t){return a("el-card",{key:t.id,staticClass:"recommend-card",attrs:{"body-style":{padding:"10px"},shadow:"never"}},[a("div",{staticClass:"recommend-title"},[e._v(e._s(t.name))]),a("div",{staticClass:"recommend-list"},[a("div",{staticClass:"jquery-scrollbar-element"},e._l(t.list,(function(t){return a("div",{key:t.id,staticClass:"recomment-item"},[a("div",{staticClass:"ri-title"},[e._v(e._s(t.product.productName))]),a("div",{staticClass:"ri-desc",attrs:{title:t.product.description}},[e._v(e._s(t.product.description))]),a("div",{staticClass:"ri-img"},[a("el-image",{staticClass:"eimg",attrs:{fit:"fill",src:t.product.imgUrl,"preview-src-list":[t.product.imgUrl]}})],1)])})),0)])])}))],2)],1)])],1)],1)])},C=[],_={data:function(){return{tableInfo:{page_num:1,page_size:8,total_num:1,tableData:[]},recommends:[],searchInfo:{keyword:""}}},mounted:function(){this.getTableInfo(),this.getRecommends()},methods:{getRecommends:function(){var e=this;return r["a"].post("/open/index/getRecommend",{}).then((function(t){t&&1==t.code&&t.data&&(e.recommends=t.data)}))},goStore:function(e){this.$router.push({path:"/storeDetail",query:{storeId:e.id}})},changePage:function(e){this.tableInfo.page_num=e,this.getTableInfo()},changePageSize:function(e){this.tableInfo.page_size=e,this.getTableInfo()},getTableInfo:function(){this.getStoreInfo()},getStoreInfo:function(){var e=this,t=this.tableInfo,a={},o=this.searchInfo.keyword;return o&&(a={keyword:o}),r["a"].post("/open/index/storeList",Object(l["a"])({page_num:t.page_num,page_size:t.page_size},a)).then((function(t){t&&1==t.code&&t.data&&(e.tableInfo=t.data)}))},getSearchInfo:function(){this.getTableInfo()}}},x=_,S=(a("fbd2"),Object(g["a"])(x,k,C,!1,null,"a1fc5a20",null)),$=S.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"center-box"},[a("div",{staticClass:"top-box"},[a("div",{staticClass:"back-box"},e._l(e.storeInfo,(function(e){return a("el-image",{key:e.id,staticClass:"store-image",attrs:{fit:"fit",src:e.logo,"preview-src-list":[e.logo]}})})),1),a("div",{staticClass:"intro-div"},[a("div",{staticClass:"title-line"},[e._v(e._s(e.store.storeName))]),a("div",{staticClass:"store-address"},[e._v("地址："+e._s(e.store.address))]),a("div",{staticClass:"store-meta"},[a("span",{staticClass:"min-cost smw"},[e._v("¥"+e._s(e.store.minCost)+"起送")]),a("span",{staticClass:"post-fee smw"},[e._v("配送费¥"+e._s(e.store.postFee))])]),a("div",{staticClass:"store-intro",attrs:{title:e.store.description}},[e._v("简介："+e._s(e.store.description))])])]),a("div",{staticClass:"article-box"},[a("el-tabs",{attrs:{"tab-position":"left"},model:{value:e.currentCategory,callback:function(t){e.currentCategory=t},expression:"currentCategory"}},e._l(e.productList,(function(t,o){return a("el-tab-pane",{key:t.id,attrs:{label:t.name}},e._l(t.list,(function(t,i){return a("div",{key:t.id,staticClass:"product-info-item"},[a("span",{staticClass:"left-image",on:{click:function(e){e.stopPropagation()}}},[a("el-image",{staticClass:"limg",attrs:{fit:"fill",src:t.imgUrl,"preview-src-list":[t.imgUrl]}})],1),a("span",{staticClass:"right-introduce"},[a("div",{staticClass:"store-name"},[e._v(e._s(t.productName))]),a("div",{staticClass:"store-meta"},[a("span",{staticClass:"min-cost smw"},[e._v("库存"+e._s(t.stock)+" ")]),a("span",{staticClass:"post-fee smw red-word"},[e._v("¥"+e._s(t.price))])]),a("div",{staticClass:"store-intro",attrs:{title:t.description}},[e._v(e._s(t.description))]),a("div",{staticClass:"tools-div"},[a("el-button",{attrs:{type:"warning",icon:"el-icon-minus",size:"mini",circle:""},on:{click:function(a){return e.setCart(t.id,-1)}}}),a("span",{staticClass:"buy-num",staticStyle:{margin:"0 10px"}},[e._v(e._s(e.cartCounts[o][i]))]),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",circle:""},on:{click:function(a){return e.setCart(t.id,1,t.stock)}}})],1)])])})),0)})),1)],1)])])},T=[],P={props:{cart:{type:Array,default:function(){return[]}}},data:function(){return{currentCategory:"",storeId:"",productList:[],store:{id:"",logo:"",storeName:"",address:"",minCost:"",postFee:"",description:""}}},mounted:function(){this.storeId=this.$route.query.storeId,this.getStoreInfo(),this.getProductList()},computed:{storeInfo:function(){return this.store.id?[this.store]:[]},cartCounts:function(){var e={};this.cart.forEach((function(t){e[t.productId]=t.count}));var t=this.productList.map((function(t){return t.list.map((function(t){return e[t.id]||0}))}));return t}},methods:{setCart:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=function(e){return o&&(e=e>o?o:e),e=e<0?0:e,e},s=this.cart,n=-1,l=-2;for(t=0;t<s.length;t++){var r=s[t];if(r.productId==e){n=r.count,l=r.count=i(r.count- -a);break}}t>=s.length&&s.push({productId:e,count:i(a)}),0==l&&s.splice(t,1),n!=l&&this.$emit("cart-change",this.storeId,s)},getStoreInfo:function(){var e=this;return r["a"].post("/open/index/getStoreInfo",{storeId:this.storeId}).then((function(t){t&&1==t.code&&t.data&&(e.store=t.data)}))},getProductList:function(){var e=this;return r["a"].post("/open/index/getProductList",{storeId:this.storeId}).then((function(t){t&&1==t.code&&t.data&&(e.productList=t.data)}))}}},A=P,N=(a("dcbb"),Object(g["a"])(A,z,T,!1,null,"234fb594",null)),O=N.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("router-view")],1)},E=[],V={},j=Object(g["a"])(V,D,E,!1,null,null,null),L=j.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"outer-div"},[a("el-dropdown",{staticClass:"cbutton"},[a("span",{staticClass:"person-center-button"},[e._v("其他登录")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("router-link",{staticClass:"alink",attrs:{to:"/admin/login"}},[e._v("管理员登录")])],1),a("el-dropdown-item",[a("router-link",{staticClass:"alink",attrs:{to:"/"}},[e._v("返回首页")])],1),a("el-dropdown-item",[a("router-link",{staticClass:"alink",attrs:{to:"/delivery/login"}},[e._v("配送员登录")])],1)],1)],1),a("div",{staticClass:"login-div"},[a("h2",{staticClass:"title-text"},[e._v("商家管理")]),a("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{placeholder:"注册时的手机号码或邮箱"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入密码"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loginAction("loginForm")}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.loginAction("loginForm")}}},[e._v("登录")]),a("el-button",{on:{click:function(t){return e.resetForm("loginForm")}}},[e._v("重置")])],1)],1)],1)],1)},M=[],U=(a("ecb4"),{data:function(){var e=function(e,t,a){if(!t)return a(new Error("请输入手机号码或邮箱"));a()},t=function(e,t,a){""===t?a(new Error("请输入密码")):a()};return{toURL:this.$route.query.from||"/store/menu",loginForm:{username:"",password:""},rules:{username:[{validator:e,trigger:"blur"}],password:[{validator:t,trigger:"blur"}]}}},created:function(){var e=this,t="store";r["a"].get("/open/loginStatus").then((function(a){if(a&&1==a.code){var o=a.data;o.roles instanceof Array&&o.roles.map((function(e){return e.name})).indexOf(t)&&e.$router.push(e.toURL)}}))},methods:{loginAction:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$alert("信息填写有误，请检查用户名和密码","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/open/storeLogin",t.loginForm).then((function(e){e&&1==e.code?t.$message({message:"登录成功",type:"success",showClose:!0,onClose:function(){t.$router.push(t.toURL)}}):e.tips&&t.$alert(e.tips,"登录失败",{confirmButtonText:"确定"})}))}))},resetForm:function(e){this.$refs[e].resetFields()}}}),B=U,q=(a("6b1a"),Object(g["a"])(B,F,M,!1,null,"be84fbee",null)),R=q.exports,J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home-div"},[a("div",{staticClass:"header-div"},[a("span",{staticClass:"username",on:{click:e.editProfile}},[a("i",{staticClass:"el-icon-user-solid"}),a("span",{staticClass:"username-span"},[e._v(e._s(e.userInfo.nickname||e.userInfo.username))])]),a("span",[a("router-link",{staticClass:"alink",attrs:{to:"/"}},[e._v("返回首页")])],1),a("span",[a("router-link",{staticClass:"alink",staticStyle:{"margin-left":"10px"},attrs:{to:"/admin/menu"}},[e._v("管理员登录")])],1),a("span",{staticClass:"logout-button",on:{click:e.logout}},[a("i",{staticClass:"el-icon-switch-button"}),e._v("退出 ")])]),a("el-menu",{staticClass:"left-menu",attrs:{"unique-opened":"",router:"","default-active":e.$route.path,collapse:e.leftMenu.isCollapse},on:{open:function(t){return e.collapseLeft(!0)},close:function(t){return e.collapseLeft(!1)}}},e._l(e.leftMenu.navList,(function(t){return a(t.children&&t.children.length>0?"el-submenu":"el-menu-item",{key:t.title+t.url,tag:"component",staticClass:"menu-item",attrs:{index:t.url}},[a("template",{slot:"title"},[a("i",{class:[t.icon]}),a("span",[e._v(e._s(t.title))])]),t.children&&t.children.length>0?e._l(t.children,(function(t,o){return a("el-menu-item",{key:t.url+o,staticClass:"menu-item",attrs:{index:t.url}},[a("i",{class:[t.icon]}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])})):e._e()],2)})),1),a("div",{staticClass:"right-part",class:{collapse:e.leftMenu.isCollapse}},[a("div",{staticClass:"article-div"},[a("router-view",{on:{"update-user":e.getUserInfo}})],1)])],1)},Q=[];window.axios=r["a"];var Z={data:function(){return{userInfo:{username:"",nickname:""},leftMenu:{isCollapse:!1,navList:[{icon:"el-icon-document",title:"订单管理",url:"/store/menu/OrderManage"},{icon:"el-icon-dish",title:"商品管理",url:"/store/menu/ProductManage"},{icon:"el-icon-suitcase",title:"店铺管理",url:"/store/menu/StoreProfile"},{icon:"el-icon-setting",title:"评价管理",url:"/store/menu/CommendManage"},{icon:"el-icon-user",title:"个人资料",url:"/store/menu/PersonProfile"}]}}},mounted:function(){window.$=this.$,this.getUserInfo()},methods:{getUserInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!=t&&t!=this.userInfo.id||r["a"].get("/open/loginStatus").then((function(t){t&&1==t.code&&(e.userInfo=t.data)}))},logout:function(){var e=this;r["a"].get("/logout").then((function(){e.$router.push("/store/login")}))},collapseLeft:function(){},editProfile:function(){this.$router.push("/store/menu/PersonProfile")}}},W=Z,H=(a("4221"),Object(g["a"])(W,J,Q,!1,null,"80791c2e",null)),K=H.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"product-manage-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"orders-div"},[a("div",{staticClass:"tools-div"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchInfo}},[a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.statusList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入商品名称/编号/描述","prefix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchInfo()}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getSearchInfo()}}},[e._v("查询")])],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-plus"},on:{click:function(t){e.dialog.addCategoryVisible=!0}}},[e._v("添加分类")])],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",type:"success",icon:"el-icon-plus"},on:{click:e.showAddProduct}},[e._v("添加商品")])],1)],1)],1),a("div",{staticClass:"order-table"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.updateInfo},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"菜单列表",name:"menuList"}},[a("div",{staticClass:"category-tags"},e._l(e.tableInfo.categories,(function(t,o){return a("el-tag",{key:t.categoryId,staticClass:"category-tag",attrs:{size:"small",closable:""},on:{click:e.selectCategory,close:function(t){return e.deleteCategory(o)}},nativeOn:{click:function(t){return e.showEditCategory(t,o)}}},[e._v(e._s(t.categoryName)),a("i",{staticClass:"el-icon-edit edit-category"})])})),1),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getTableInfo()}}}),a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableInfo.tableData},on:{"expand-change":e.updateScrollbar}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e._l(e.tableInfo.stringMap,(function(o,i){return a("el-form-item",{key:o.id,attrs:{label:e.tableInfo.stringMap[i]}},[a("span",[e._v(e._s(t.row[i]))])])})),a("el-form-item",{attrs:{label:"商品图片"}},[a("el-avatar",{attrs:{shape:"square",size:100,fit:"cover",src:t.row["imgUrl"]}})],1)],2)]}}])}),a("el-table-column",{attrs:{label:"商品 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"商品名称",prop:"productName"}}),a("el-table-column",{attrs:{label:"价格",prop:"price"}}),a("el-table-column",{attrs:{label:"库存",prop:"stock"}}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",title:"编辑",size:"small"},on:{click:function(a){return e.showEditProduct(t.$index)}}}),t.row.status?a("el-button",{attrs:{type:"success",icon:"el-icon-upload2",circle:"",title:"上架",size:"small"},on:{click:function(a){return e.changeStatus(t.$index,!0)}}}):a("el-button",{attrs:{type:"warning",icon:"el-icon-download",circle:"",title:"下架",size:"small"},on:{click:function(a){return e.changeStatus(t.$index,!1)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",title:"删除",size:"small"},on:{click:function(a){return e.deleteProduct(t.$index)}}})]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.tableInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.tableInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.tableInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changePageSize,"current-change":e.changePage}})],1)]),a("el-tab-pane",{attrs:{label:"搜索结果",name:"searchResult"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getSearchInfo(!0)}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchInfo.tableData},on:{"expand-change":e.updateScrollbar}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e._l(e.tableInfo.stringMap,(function(o,i){return a("el-form-item",{key:o.id,attrs:{label:e.tableInfo.stringMap[i]}},[a("span",[e._v(e._s(t.row[i]))])])})),a("el-form-item",{attrs:{label:"商品图片"}},[a("el-avatar",{attrs:{shape:"square",size:100,fit:"cover",src:t.row["imgUrl"]}})],1)],2)]}}])}),a("el-table-column",{attrs:{label:"商品 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"商品名称",prop:"productName"}}),a("el-table-column",{attrs:{label:"价格",prop:"price"}}),a("el-table-column",{attrs:{label:"库存",prop:"stock"}}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",title:"编辑",size:"small"},on:{click:function(a){return e.showEditProduct(t.$index)}}}),t.row.status?a("el-button",{attrs:{type:"success",icon:"el-icon-upload2",circle:"",title:"上架",size:"small"},on:{click:function(a){return e.changeStatus(t.$index,!0)}}}):a("el-button",{attrs:{type:"warning",icon:"el-icon-download",circle:"",title:"下架",size:"small"},on:{click:function(a){return e.changeStatus(t.$index,!1)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",title:"删除",size:"small"},on:{click:function(a){return e.deleteProduct(t.$index)}}})]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.searchInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.searchInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.searchInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changeSearchPageSize,"current-change":e.changeSearchPage}})],1)])],1)],1)]),a("el-dialog",{attrs:{title:"添加分类",visible:e.dialog.addCategoryVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"addCategoryVisible",t)}}},[a("el-form",{attrs:{model:e.dialog.newCategory}},[a("el-form-item",{attrs:{label:"分类名称","label-width":"120px"}},[a("el-input",{attrs:{autocomplete:"off"},nativeOn:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.dialogFormVisible=!1,e.addCategory()}},model:{value:e.dialog.newCategory.categoryName,callback:function(t){e.$set(e.dialog.newCategory,"categoryName",t)},expression:"dialog.newCategory.categoryName"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.addCategoryVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialog.addCategoryVisible=!1,e.addCategory()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑分类",visible:e.dialog.editCategoryVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"editCategoryVisible",t)}}},[a("el-form",{attrs:{model:e.dialog.editCategory}},[a("el-form-item",{attrs:{label:"分类名称","label-width":"120px"}},[a("el-input",{attrs:{disabled:""},model:{value:e.dialog.editCategory.oldName,callback:function(t){e.$set(e.dialog.editCategory,"oldName",t)},expression:"dialog.editCategory.oldName"}})],1),a("el-form-item",{attrs:{label:"编辑名称","label-width":"120px"}},[a("el-input",{attrs:{placeholder:"请输入名称",autocomplete:"off"},nativeOn:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.editCategoryVisible=!1,e.editCategory()}},model:{value:e.dialog.editCategory.categoryName,callback:function(t){e.$set(e.dialog.editCategory,"categoryName",t)},expression:"dialog.editCategory.categoryName"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.editCategoryVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialog.editCategoryVisible=!1,e.editCategory()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"添加商品",visible:e.dialog.addProductVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"addProductVisible",t)}}},[a("el-form",{attrs:{model:e.dialog.newProduct,"status-icon":"",rules:e.dialog.rules}},[a("el-form-item",{attrs:{label:"商品名称","label-width":"120px",prop:"productName"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入商品名称"},model:{value:e.dialog.newProduct.productName,callback:function(t){e.$set(e.dialog.newProduct,"productName",t)},expression:"dialog.newProduct.productName"}})],1),a("el-form-item",{attrs:{label:"描述","label-width":"120px",prop:"description"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入描述",autocomplete:"off"},model:{value:e.dialog.newProduct.description,callback:function(t){e.$set(e.dialog.newProduct,"description",t)},expression:"dialog.newProduct.description"}})],1),a("el-form-item",{attrs:{label:"分类","label-width":"120px"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.dialog.newProduct.categoryId,callback:function(t){e.$set(e.dialog.newProduct,"categoryId",t)},expression:"dialog.newProduct.categoryId"}},e._l(e.tableInfo.categories,(function(e){return a("el-option",{key:e.id,attrs:{label:e.categoryName,value:e.categoryId}})})),1)],1),a("el-form-item",{attrs:{label:"价格","label-width":"120px",prop:"price"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入价格",autocomplete:"off"},model:{value:e.dialog.newProduct.price,callback:function(t){e.$set(e.dialog.newProduct,"price",t)},expression:"dialog.newProduct.price"}})],1),a("el-form-item",{attrs:{label:"库存","label-width":"120px",prop:"stock"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入库存",autocomplete:"off"},model:{value:e.dialog.newProduct.stock,callback:function(t){e.$set(e.dialog.newProduct,"stock",t)},expression:"dialog.newProduct.stock"}})],1),a("el-form-item",{attrs:{label:"图片","label-width":"120px",prop:"imgUrl"}},[a("el-upload",{staticClass:"upload-image",attrs:{"on-success":e.uploadIconSuccess,action:e.uploadUrl,limit:1,name:"file","list-type":"picture-card","before-upload":e.beforeIconUpload,"on-exceed":e.uploadExcced}},[a("i",{staticClass:"el-icon-plus"})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.addProductVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addProduct}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑商品",visible:e.dialog.editProductVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"editProductVisible",t)}}},[a("el-form",{attrs:{model:e.dialog.editProduct,"status-icon":"",rules:e.dialog.rules}},[a("el-form-item",{attrs:{label:"商品名称","label-width":"120px",prop:""}},[a("el-input",{attrs:{size:"small",placeholder:"请输入商品名称"},model:{value:e.dialog.editProduct.productName,callback:function(t){e.$set(e.dialog.editProduct,"productName",t)},expression:"dialog.editProduct.productName"}})],1),a("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入描述",autocomplete:"off"},model:{value:e.dialog.editProduct.description,callback:function(t){e.$set(e.dialog.editProduct,"description",t)},expression:"dialog.editProduct.description"}})],1),a("el-form-item",{attrs:{label:"分类","label-width":"120px"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.dialog.editProduct.categoryId,callback:function(t){e.$set(e.dialog.editProduct,"categoryId",t)},expression:"dialog.editProduct.categoryId"}},e._l(e.tableInfo.categories,(function(e){return a("el-option",{key:e.id,attrs:{label:e.categoryName,value:e.categoryId}})})),1)],1),a("el-form-item",{attrs:{label:"价格","label-width":"120px"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入价格",autocomplete:"off"},model:{value:e.dialog.editProduct.price,callback:function(t){e.$set(e.dialog.editProduct,"price",t)},expression:"dialog.editProduct.price"}})],1),a("el-form-item",{attrs:{label:"库存","label-width":"120px"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入库存",autocomplete:"off"},model:{value:e.dialog.editProduct.stock,callback:function(t){e.$set(e.dialog.editProduct,"stock",t)},expression:"dialog.editProduct.stock"}})],1),a("el-form-item",{attrs:{label:"图片","label-width":"120px",prop:"imgUrl"}},[a("el-upload",{staticClass:"upload-image",attrs:{"on-success":e.editIconSuccess,action:e.uploadUrl,limit:1,name:"file","list-type":"picture-card","before-upload":e.beforeIconUpload,"on-exceed":e.uploadExcced,"file-list":e.dialog.editProduct.fileList}},[a("i",{staticClass:"el-icon-plus"})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.editProductVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editProduct()}}},[e._v("确 定")])],1)],1)],1)])])},X=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("商品管理")])])])}],Y=(a("d497"),a("b92a"),a("33a2"),a("e35a"),a("0d7a"),{data:function(){return{host:window.location.protocol+"//"+window.location.host,uploadUrl:"/store/uploadIcon",dialog:{addCategoryVisible:!1,addProductVisible:!1,editCategoryVisible:!1,editProductVisible:!1,editProductIndex:-1,editCategoryIndex:-1,newCategory:{categoryName:""},editCategory:{categoryName:"",oldName:""},newProduct:{id:"",productName:"",price:"",stock:"",imgUrl:"",status:0,description:"",categoryId:""},rules:{productName:[{validator:function(e,t,a){t?a():a(new Error("请输入商品名称"))},trigger:"blur"}],price:[{validator:function(e,t,a){""===t?a(new Error("请输入价格")):isNaN(parseFloat(t))?a(new Error("价格输入有误，非法字符")):a()},trigger:"blur"}],stock:[{validator:function(e,t,a){""===t?a(new Error("请输入库存")):isNaN(parseInt(t))?a(new Error("库存输入有误，非法字符")):a()},trigger:"blur"}],imgUrl:[{validator:function(e,t,a){t?a():a(new Error("请选择商品图片"))},trigger:"blur"}],description:[{validator:function(e,t,a){""===t?a(new Error("请输入商品描述")):a()},trigger:"blur"}]},editProduct:{id:"",productName:"",price:"",stock:"",imgUrl:"",status:0,description:"",categoryId:""}},activeTab:"menuList",statusOptions:[{label:"正常",value:0},{label:"已下架",value:1}],statusList:[{label:"全部",value:-1},{label:"正常",value:0},{label:"已下架",value:1}],categoryIdMap:{},searchInfo:{keyword:"",status:-1,page_num:1,page_size:8,total_num:1,tableData:[]},status:-1,keyword:"",tableInfo:{page_num:1,page_size:8,total_num:1,categories:[],stringMap:{id:"商品ID",productName:"商品名称",categoryName:"分类",description:"描述",price:"价格",stock:"库存",updateTime:"更新时间",createTime:"创建时间"},tableData:[]}}},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar(),this.getTableInfo()},methods:{updateScrollbar:function(e,t){var a=this;this.$nextTick((function(){0!=t.length&&!0!==e||a.$(".table-div").updateScrollbars(!0)}))},uploadExcced:function(){this.$message({message:"仅支持单个图片上传，点击删除原图片后重新选择",type:"warning"})},beforeIconUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传图片大小不能超过 2MB!"),t},changeSearchPage:function(e){this.searchInfo.page_num=e,this.getSearchInfo(!0)},changeSearchPageSize:function(e){this.searchInfo.page_size=e,this.getSearchInfo(!0)},changePage:function(e){this.tableInfo.page_num=e,this.getTableInfo()},changePageSize:function(e){this.tableInfo.page_size=e,this.getTableInfo()},updateInfo:function(){return"menuList"==this.activeTab?this.getTableInfo():this.getSearchInfo(!0)},getTableInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=t?this.searchInfo:this.tableInfo,o={};return t&&(o={keyword:this.searchInfo.keyword,status:this.searchInfo.status}),r["a"].get("/store/productList",Object(l["a"])({page_num:a.page_num,page_size:a.page_size},o)).then((function(a){if(a&&1==a.code&&a.data){var o={};a.data.categories.map((function(e,t){a.data.categories[t].categoryName=e.name,a.data.categories[t].categoryId=e.id,o[e.id]=e.name})),e.categoryIdMap=o,a.data.tableData.forEach((function(e){e.categoryName=o[e.categoryId]})),t?e.searchInfo=Object.assign(e.searchInfo,a.data):e.tableInfo=Object.assign(e.tableInfo,a.data)}}))},getSearchInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e||(this.searchInfo.keyword=this.keyword,this.searchInfo.status=this.status),this.activeTab="searchResult",this.getTableInfo(!0)},showAddProduct:function(){this.dialog.addProductVisible=!0,this.dialog.newProduct.status=0;try{this.dialog.newProduct.categoryId=this.tableInfo.categories[0].categoryId}catch(e){}},showEditProduct:function(e){var t="menuList"==this.activeTab?this.tableInfo:this.searchInfo;this.dialog.editProductIndex=e,this.dialog.editProductVisible=!0;var a=this.dialog.editProduct=JSON.parse(JSON.stringify(t.tableData[e]));a.imgUrl&&this.$set(this.dialog.editProduct,"fileList",[{name:a.imgUrl.split("/").pop(),url:a.imgUrl}])},addProduct:function(){this.editProduct(!0)},editProduct:function(){var e,t=this,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o="menuList"==this.activeTab?this.tableInfo:this.searchInfo,i=this.dialog.editProductIndex,s=a?"添加":"编辑";a?(e=this.dialog.newProduct,this.dialog.addProductVisible=!1):(e=this.dialog.editProduct,this.dialog.editProductVisible=!1),r["a"].post("/store/saveProduct",e).then((function(e){if(e&&1==e.code)if(t.$message({message:s+"商品成功",type:"success"}),a)for(var n in t.updateInfo(),t.dialog.newProduct)t.dialog.newProduct[n]="";else o.tableData[i]=e.data;else t.$alert(e.tips,s+"商品失败",{confirmButtonText:"确定"})}))},deleteProduct:function(e){var t=this;this.$confirm("此操作将永久删除该商品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a="menuList"==t.activeTab?t.tableInfo:t.searchInfo,o=a.tableData[e].id;r["a"].post("/store/deleteProduct",{id:o}).then((function(e){e&&1==e.code?(t.$message({message:"删除商品成功",type:"success"}),t.updateInfo().then((function(){t.updateScrollbar(!0,[])}))):t.$alert(e.tips,"删除商品失败",{confirmButtonText:"确定"})}))}))["catch"]((function(){t.$message({type:"info",message:"已取消删除"})}))},showEditCategory:function(e,t){e.target.classList.contains("edit-category")&&(this.dialog.editCategoryIndex=t,this.dialog.editCategoryVisible=!0,this.dialog.editCategory.categoryName=this.dialog.editCategory.oldName=this.tableInfo.categories[t].categoryName)},changeStatus:function(e,t){var a=this,o=t?"/store/onSaleProduct":"/store/offSaleProduct",i=t?"上架":"下架",s="menuList"==this.activeTab?this.tableInfo:this.searchInfo,n=s.tableData[e].id;r["a"].get(o,{id:n}).then((function(e){if(e&&1==e.code){a.$message({message:i+"商品成功",type:"success"});var o=-1;s.tableData.some((function(e,t){if(e.id==n)return o=t,!0}));var l=t?0:1;o>=0&&(s.tableData[o].status=l)}else a.$alert(e.tips,i+"商品失败",{confirmButtonText:"确定"})}))},addCategory:function(){this.editCategory(!0),this.dialog.newCategory.categoryName=""},editCategory:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.dialog.editCategoryVisible=!1,this.dialog.addCategoryVisible=!1;var a=this.dialog.editCategoryIndex,o="",i=this.dialog.editCategory.categoryName,s=t?"添加":"编辑";t?i=this.dialog.newCategory.categoryName:o=this.tableInfo.categories[a].categoryId,r["a"].post("/store/saveCategory",{categoryId:o,categoryName:i}).then((function(o){o&&1==o.code?(e.$message({message:s+"分类成功",type:"success"}),t?(o.data.categoryName=o.data.name,o.data.categoryId=o.data.id,e.tableInfo.categories.push(o.data)):e.tableInfo.categories[a].categoryName=i):e.$alert(o.tips,s+"分类失败",{confirmButtonText:"确定"})}))},selectCategory:function(){},deleteCategory:function(e){var t=this;this.$confirm("此操作将永久删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=t.tableInfo.categories[e].categoryId;r["a"].post("/store/deleteCategory",{categoryId:a}).then((function(e){if(e&&1==e.code){t.$message({message:"删除分类成功",type:"success"});var o=-1;t.tableInfo.categories.some((function(e,t){if(e.categoryId==a)return o=t,!0})),o>=0&&t.tableInfo.categories.splice(o,1)}else t.$alert(e.tips,"删除分类失败",{confirmButtonText:"确定"})}))}))["catch"]((function(){t.$message({type:"info",message:"已取消删除"})}))},uploadIconSuccess:function(e){e&&1==e.code&&(this.dialog.newProduct.imgUrl=e.data)},editIconSuccess:function(e){e&&1==e.code&&(this.dialog.editProduct.imgUrl=e.data)}}}),ee=Y,te=(a("bf5d"),Object(g["a"])(ee,G,X,!1,null,"3a7aa106",null)),ae=te.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"order-manage-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"orders-div"},[a("div",{staticClass:"tools-div"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchInfo}},[a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.orderStatus,callback:function(t){e.orderStatus=t},expression:"orderStatus"}},e._l(e.statusList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入用户昵称/联系方式/订单编号","prefix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchInfo()}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getSearchInfo()}}},[e._v("查询")])],1)],1)],1),a("div",{staticClass:"order-table"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.updateInfo},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"订单列表",name:"menuList"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getTableInfo()}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableInfo.tableData,border:""},on:{"expand-change":e.updateScrollbar}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e._l(e.tableInfo.stringMap,(function(o,i){return a("el-form-item",{key:o.id,attrs:{label:e.tableInfo.stringMap[i]}},[a("span",[e._v(e._s(t.row[i]))])])})),a("el-form-item",{attrs:{label:"订单内容"}},e._l(t.row.orderDetailList,(function(t){return a("div",{key:t.detailId},[e._v(" "+e._s(t.productName)+" ¥"+e._s(t.productPrice)+" x "+e._s(t.productQuantity)+" ")])})),0)],2)]}}])}),a("el-table-column",{attrs:{label:"订单 ID",prop:"orderId"}}),a("el-table-column",{attrs:{label:"用户名称",prop:"buyerName"}}),a("el-table-column",{attrs:{label:"订单金额",prop:"orderAmount"}}),a("el-table-column",{attrs:{label:"联系方式",prop:"buyerPhone"}}),a("el-table-column",{attrs:{label:"订单状态",prop:"orderStatusStr"}}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",icon:"el-icon-coin",circle:"",title:"确定接单/确定支付",disabled:t.row.orderStatus!=e.actionMap["new"].status,size:"small"},on:{click:function(a){return e.changeStatus(t.$index,"pay")}}}),a("el-button",{attrs:{type:"success",icon:"el-icon-check",circle:"",title:"确定完结",disabled:[e.actionMap["new"].status,e.actionMap["pay"].status].indexOf(t.row.orderStatus)<0,size:"small"},on:{click:function(a){return e.changeStatus(t.$index,"over")}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-close",circle:"",title:"取消订单",disabled:[e.actionMap["new"].status,e.actionMap["pay"].status].indexOf(t.row.orderStatus)<0,size:"small"},on:{click:function(a){return e.changeStatus(t.$index,"cancel")}}})]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.tableInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.tableInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.tableInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changePageSize,"current-change":e.changePage}})],1)]),a("el-tab-pane",{attrs:{label:"搜索结果",name:"searchResult"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getSearchInfo(!0)}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchInfo.tableData,border:""},on:{"expand-change":e.updateScrollbar}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e._l(e.tableInfo.stringMap,(function(o,i){return a("el-form-item",{key:o.id,attrs:{label:e.tableInfo.stringMap[i]}},[a("span",[e._v(e._s(t.row[i]))])])})),a("el-form-item",{attrs:{label:"订单内容"}},e._l(t.row.orderDetailList,(function(t){return a("div",{key:t.detailId},[e._v(" "+e._s(t.productName)+" ¥"+e._s(t.productPrice)+" x "+e._s(t.productQuantity)+" ")])})),0)],2)]}}])}),a("el-table-column",{attrs:{label:"订单 ID",prop:"orderId"}}),a("el-table-column",{attrs:{label:"用户名称",prop:"buyerName"}}),a("el-table-column",{attrs:{label:"订单金额",prop:"orderAmount"}}),a("el-table-column",{attrs:{label:"联系方式",prop:"buyerPhone"}}),a("el-table-column",{attrs:{label:"订单状态",prop:"orderStatusStr"}}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",icon:"el-icon-coin",circle:"",title:"确定接单/确定支付",disabled:t.row.orderStatus!=e.actionMap["new"].status,size:"small"},on:{click:function(a){return e.changeStatus(t.$index,"pay")}}}),a("el-button",{attrs:{type:"success",icon:"el-icon-check",circle:"",title:"确定完结",disabled:e.actionMap["over"].status<=t.row.orderStatus,size:"small"},on:{click:function(a){return e.changeStatus(t.$index,"over")}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-close",circle:"",title:"取消订单",disabled:e.actionMap["over"].status<=t.row.orderStatus,size:"small"},on:{click:function(a){return e.changeStatus(t.$index,"cancel")}}})]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.searchInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.searchInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.searchInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changeSearchPageSize,"current-change":e.changeSearchPage}})],1)])],1)],1)])])])])},ie=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("订单管理")])])])}],se=(a("b4fb"),{data:function(){var e={activeTab:"menuList",statusList:[{label:"全部",value:-1},{label:"新订单未支付",value:0},{label:"已支付/接单",value:1},{label:"配送中",value:3},{label:"已完结",value:4},{label:"已评价",value:5},{label:"已取消",value:6}],actionMap:{new:{status:0},pay:{url:"/store/order/confirmPay",tips:"确认支付",status:1},accept:{url:"/store/order/confirmPay",tips:"确认接单",status:1},delivery:{status:3},over:{url:"/store/order/finish",tips:"确认完结",status:4},cancel:{url:"/store/order/cancel",tips:"订单取消",status:6}},statusMap:{},searchInfo:{keyword:"",orderStatus:-1,page_num:1,page_size:8,total_num:1,tableData:[]},orderStatus:-1,keyword:"",tableInfo:{page_num:1,page_size:8,total_num:1,stringMap:{orderId:"订单ID",buyerName:"用户名称",buyerAddress:"地址",buyerPhone:"联系方式",updateTime:"更新时间",createTime:"创建时间"},tableData:[]}};return e.statusList.forEach((function(t){e.statusMap[t.value]=t.label})),e},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar(),this.getTableInfo()},methods:{updateScrollbar:function(e,t){var a=this;this.$nextTick((function(){0!=t.length&&!0!==e||a.$(".table-div").updateScrollbars(!0)}))},changeSearchPage:function(e){this.searchInfo.page_num=e,this.getSearchInfo(!0)},changeSearchPageSize:function(e){this.searchInfo.page_size=e,this.getSearchInfo(!0)},changePage:function(e){this.tableInfo.page_num=e,this.getTableInfo()},changePageSize:function(e){this.tableInfo.page_size=e,this.getTableInfo()},updateInfo:function(){"menuList"==this.activeTab?this.getTableInfo():this.getSearchInfo(!0)},getTableInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=t?this.searchInfo:this.tableInfo,o={};t&&(o={keyword:this.searchInfo.keyword,status:this.searchInfo.orderStatus}),r["a"].get("/store/order/list",Object(l["a"])({page_num:a.page_num,page_size:a.page_size},o)).then((function(a){a&&1==a.code&&a.data&&(a.data.tableData.forEach((function(t){t.orderStatusStr=e.statusMap[t.orderStatus]})),t?e.searchInfo=Object.assign(e.searchInfo,a.data):e.tableInfo=Object.assign(e.tableInfo,a.data))}))},getSearchInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e||(this.searchInfo.keyword=this.keyword,this.searchInfo.orderStatus=this.orderStatus),this.activeTab="searchResult",this.getTableInfo(!0)},changeStatus:function(e,t){var a=this,o=this.actionMap[t],i=o.url,s=o.tips,n="menuList"==this.activeTab?this.tableInfo:this.searchInfo,l=n.tableData[e].orderId;this.$confirm("将".concat(l,"号订单").concat(s,", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r["a"].get(i,{orderId:l}).then((function(e){if(e&&1==e.code){a.$message({message:s+"成功",type:"success"});var t=-1;n.tableData.some((function(e,a){if(e.orderId==l)return t=a,!0}));var i=o.status;t>=0&&(n.tableData[t].orderStatus=i,n.tableData[t].orderStatusStr=a.statusMap[i])}else a.$alert(e.tips,s+"失败",{confirmButtonText:"确定"})}))}))["catch"]((function(){a.$message({type:"info",message:"已取消"})}))}}}),ne=se,le=(a("293e"),Object(g["a"])(ne,oe,ie,!1,null,"6f7cf688",null)),re=le.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"store-profile-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"tab-div"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.tabChange},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"店铺信息",name:"info"}},[a("el-form",{attrs:{"label-position":"right","label-width":"80px",model:e.storeInfo}},[a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"店铺 ID:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.storeInfo.id))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"店名:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.storeInfo.storeName))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"联系方式:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.storeInfo.phone))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"起送金额:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.storeInfo.minCost))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"配送费:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.storeInfo.postFee))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"地址:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.storeInfo.address))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"LOGO:"}},[e.storeInfo.id?a("el-image",{staticClass:"limg",staticStyle:{width:"200px",height:"200px"},attrs:{fit:"fill",src:e.storeInfo.logo,"preview-src-list":[e.storeInfo.logo]}}):e._e()],1),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"创建时间:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.storeInfo.createTime))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"更新时间:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.storeInfo.updateTime))])])],1)],1),a("el-tab-pane",{attrs:{label:"修改资料",name:"edit"}},[a("el-form",{ref:"storeForm",attrs:{"label-position":"right","label-width":"80px",model:e.store,rules:e.rules}},[a("el-form-item",{staticClass:"first-line",attrs:{label:"店名",prop:"storeName"}},[a("el-input",{attrs:{placeholder:"请输入店铺名称"},model:{value:e.store.storeName,callback:function(t){e.$set(e.store,"storeName",t)},expression:"store.storeName"}})],1),a("el-form-item",{attrs:{label:"联系方式",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入联系方式"},model:{value:e.store.phone,callback:function(t){e.$set(e.store,"phone",t)},expression:"store.phone"}})],1),a("el-form-item",{attrs:{label:"地址",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入店铺地址"},model:{value:e.store.address,callback:function(t){e.$set(e.store,"address",t)},expression:"store.address"}})],1),a("el-form-item",{attrs:{label:"起送/元",prop:"minCost"}},[a("el-input",{attrs:{placeholder:"请输入起送金额"},model:{value:e.store.minCost,callback:function(t){e.$set(e.store,"minCost",t)},expression:"store.minCost"}})],1),a("el-form-item",{attrs:{label:"配送费/元",prop:"postFee"}},[a("el-input",{attrs:{placeholder:"请输入配送费"},model:{value:e.store.postFee,callback:function(t){e.$set(e.store,"postFee",t)},expression:"store.postFee"}})],1),a("el-form-item",{attrs:{lanel:"LOGO",prop:"logo"}},[a("el-upload",{staticClass:"upload-image",attrs:{"on-success":e.editIconSuccess,action:e.uploadUrl,limit:1,name:"file","list-type":"picture-card","before-upload":e.beforeIconUpload,"on-exceed":e.uploadExcced,"file-list":e.store.fileList}},[a("i",{staticClass:"el-icon-plus"})])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.editProfile}},[e._v("提交")]),a("el-button",{on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1)],1)],1)])])])},de=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("店铺资料")])])])}],ue={data:function(){return{activeTab:"info",uploadUrl:"/store/uploadIcon",storeInfo:{id:"",storeName:"",phone:"",address:"",updateTime:"",username:""},store:{storeName:"",phone:"",address:"",logo:"",minCost:0,postFee:0},rules:{storeName:[{validator:function(e,t,a){t?a():a(new Error("请输入店铺名称"))},trigger:"blur"}],address:[{validator:function(e,t,a){t?a():a(new Error("请输入店铺地址"))},trigger:"blur"}],phone:[{validator:function(e,t,a){/\d{11}/.test(t)?a():a(new Error("请输入11位手机号码"))},trigger:"blur"}]}}},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar(),this.getStoreInfo()},methods:{uploadExcced:function(){this.$message({message:"仅支持单个图片上传，点击删除原图片后重新选择",type:"warning"})},beforeIconUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传图片大小不能超过 2MB!"),t},editIconSuccess:function(e){e&&1==e.code&&(this.store.logo=e.data)},tabChange:function(){},getStoreInfo:function(){var e=this;r["a"].get("/store/info").then((function(t){if(t&&1==t.code){e.storeInfo=t.data,e.store=Object(l["a"])({},t.data);var a=e.store.logo;a&&(e.store["fileList"]=[{name:a.split("/").pop(),url:a}])}}))},resetForm:function(){this.$refs["storeForm"].resetFields()},editProfile:function(){var e=this,t=Object(l["a"])({},this.store);delete t.updateTime,delete t.createTime,this.$refs["storeForm"].validate((function(a){if(!a)return e.$alert("信息填写有误","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/store/save",t).then((function(t){t&&1==t.code?(e.$message({message:"修改资料成功",type:"success"}),e.resetForm(),e.getStoreInfo()):e.$alert(t.tips,"修改资料失败",{confirmButtonText:"确定"})}))}))}}},pe=ue,fe=(a("d5e3"),Object(g["a"])(pe,ce,de,!1,null,"1062b03c",null)),me=fe.exports,ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"account-manage-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"accounts-div"},[a("div",{staticClass:"tools-div"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchInfo}},[a("el-form-item",{attrs:{label:"查找评论:"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入内容/评论ID/用户ID","prefix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchInfo()}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getSearchInfo()}}},[e._v("查询")])],1)],1)],1),a("div",{staticClass:"account-table"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.updateInfo},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"评论列表",name:"menuList"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getTableInfo()}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableInfo.tableData,border:""},on:{"expand-change":e.updateScrollbar}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"评论内容"}},[a("div",[e._v(" "+e._s(t.row.content)+" ")])])],1)]}}])}),a("el-table-column",{attrs:{label:"评论 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"用户 ID",prop:"userId"}}),a("el-table-column",{attrs:{label:"订单 ID",prop:"orderId"}}),a("el-table-column",{attrs:{label:"昵称",prop:"nickname"}}),a("el-table-column",{attrs:{label:"评论内容"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("cutString")(t.row.content)))])]}}])}),a("el-table-column",{attrs:{label:"手机号码",prop:"phone"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"更新时间",prop:"updateTime"}})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.tableInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.tableInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.tableInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changePageSize,"current-change":e.changePage}})],1)]),a("el-tab-pane",{attrs:{label:"搜索结果",name:"searchResult"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getSearchInfo(!0)}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchInfo.tableData,border:""}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"评论内容"}},[a("div",[e._v(" "+e._s(t.row.content)+" ")])])],1)]}}])}),a("el-table-column",{attrs:{label:"评论 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"用户 ID",prop:"userId"}}),a("el-table-column",{attrs:{label:"订单 ID",prop:"orderId"}}),a("el-table-column",{attrs:{label:"昵称",prop:"nickname"}}),a("el-table-column",{attrs:{label:"评论内容"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e._f("cutString")(t.row.content)))])]}}])}),a("el-table-column",{attrs:{label:"手机号码",prop:"phone"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"更新时间",prop:"updateTime"}})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.searchInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.searchInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.searchInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changeSearchPageSize,"current-change":e.changeSearchPage}})],1)])],1)],1)])])])])},be=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("评价管理")])])])}],he={filters:{cutString:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return e?(e.length>t&&(e=e.substring(0,t)+"..."),e):""}},data:function(){var e={activeTab:"menuList",searchInfo:{keyword:"",page_num:1,page_size:8,total_num:1,tableData:[]},keyword:"",tableInfo:{page_num:1,page_size:8,total_num:1,tableData:[]}};return e},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar(),this.getTableInfo()},methods:{updateScrollbar:function(e,t){var a=this;this.$nextTick((function(){0!=t.length&&!0!==e||a.$(".table-div").updateScrollbars(!0)}))},changeSearchPage:function(e){this.searchInfo.page_num=e,this.getSearchInfo(!0)},changeSearchPageSize:function(e){this.searchInfo.page_size=e,this.getSearchInfo(!0)},changePage:function(e){this.tableInfo.page_num=e,this.getTableInfo()},changePageSize:function(e){this.tableInfo.page_size=e,this.getTableInfo()},updateInfo:function(){"menuList"==this.activeTab?this.getTableInfo():this.getSearchInfo(!0)},getTableInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=t?this.searchInfo:this.tableInfo,o={};t&&(o={keyword:this.searchInfo.keyword}),r["a"].get("/store/comment/list",Object(l["a"])({page_num:a.page_num,page_size:a.page_size},o)).then((function(a){a&&1==a.code&&a.data&&(t?e.searchInfo=Object.assign(e.searchInfo,a.data):e.tableInfo=Object.assign(e.tableInfo,a.data))}))},getSearchInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e||(this.searchInfo.keyword=this.keyword),this.activeTab="searchResult",this.getTableInfo(!0)}}},ve=he,ye=(a("6dde"),Object(g["a"])(ve,ge,be,!1,null,"0226253a",null)),Ie=ye.exports,we=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"person-profile-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"tab-div"},[a("el-tabs",{staticStyle:{height:"350px"},attrs:{"tab-position":"left"}},[a("el-tab-pane",{attrs:{label:"用户信息"}},[a("el-form",{attrs:{"label-position":"right","label-width":"80px",model:e.userInfo}},[a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"账号 ID:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.id))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"昵称:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.nickname))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"用户名:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.username))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"手机号码:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.phone))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"创建时间:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.createTime))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"更新时间:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.updateTime))])])],1)],1),a("el-tab-pane",{attrs:{label:"修改资料"}},[a("el-form",{ref:"userForm",attrs:{"label-position":"right","label-width":"80px",model:e.user,rules:e.rules}},[a("el-form-item",{staticClass:"first-line",attrs:{label:"昵称",prop:"nickname"}},[a("el-input",{attrs:{placeholder:"请输入用户昵称"},model:{value:e.user.nickname,callback:function(t){e.$set(e.user,"nickname",t)},expression:"user.nickname"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{"show-password":"",placeholder:"请输入密码，为空则不更改"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{placeholder:"请输入邮箱作为用户名"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),a("el-form-item",{attrs:{label:"手机号码"}},[a("el-input",{attrs:{placeholder:"请输入11位手机号码"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.editProfile}},[e._v("提交")]),a("el-button",{on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1)],1)],1)])])])},ke=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("个人资料")])])])}],Ce={data:function(){return{userInfo:{createTime:"",username:"",phone:"",id:"",updateTime:"",nickname:""},user:{nickname:"",password:"",username:"",phone:""},rules:{nickname:[{validator:function(e,t,a){t?a():a(new Error("请输入昵称"))},trigger:"blur"}],username:[{validator:function(e,t,a){/\d{11}/.test(t)?a():a(new Error("请输入11位手机号码"))},trigger:"blur"}]}}},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar(),this.getUserInfo()},methods:{getUserInfo:function(){var e=this;r["a"].get("/open/loginStatus").then((function(t){t&&1==t.code&&(e.userInfo=t.data,e.user.nickname=t.data.nickname,e.user.username=t.data.username,e.user.phone=t.data.phone)}))},resetForm:function(){this.$refs["userForm"].resetFields()},editProfile:function(){var e=this,t=JSON.parse(JSON.stringify(this.user));null==t.password&&delete t.password,this.$refs["userForm"].validate((function(a){if(!a)return e.$alert("信息填写有误","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/user/save",Object(l["a"])({id:e.userInfo.id},t)).then((function(t){t&&1==t.code?(e.$message({message:"修改资料成功",type:"success"}),e.resetForm(),e.getUserInfo(),e.$emit("update-user")):e.$alert(t.tips,"修改资料失败",{confirmButtonText:"确定"})}))}))}}},_e=Ce,xe=(a("1640"),Object(g["a"])(_e,we,ke,!1,null,"164ad993",null)),Se=xe.exports,$e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"outer-div"},[a("el-dropdown",{staticClass:"cbutton"},[a("span",{staticClass:"person-center-button"},[e._v("其他登录")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("router-link",{staticClass:"alink",attrs:{to:"/store/login"}},[e._v("商家登录")])],1),a("el-dropdown-item",[a("router-link",{staticClass:"alink",attrs:{to:"/"}},[e._v("返回首页")])],1),a("el-dropdown-item",[a("router-link",{staticClass:"alink",attrs:{to:"/delivery/login"}},[e._v("配送员登录")])],1)],1)],1),a("div",{staticClass:"login-div"},[a("h2",{staticClass:"title-text"},[e._v("管理员登录")]),a("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{placeholder:"注册时的手机号码或邮箱"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入密码"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loginAction("loginForm")}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.loginAction("loginForm")}}},[e._v("登录")]),a("el-button",{on:{click:function(t){return e.resetForm("loginForm")}}},[e._v("重置")])],1)],1)],1)],1)},ze=[],Te={data:function(){var e=function(e,t,a){if(!t)return a(new Error("请输入手机号码或邮箱"));a()},t=function(e,t,a){""===t?a(new Error("请输入密码")):a()};return{toURL:this.$route.query.from||"/admin/menu",loginForm:{username:"",password:""},rules:{username:[{validator:e,trigger:"blur"}],password:[{validator:t,trigger:"blur"}]}}},created:function(){var e=this,t="admin";r["a"].get("/open/loginStatus").then((function(a){if(a&&1==a.code){var o=a.data;o.roles instanceof Array&&o.roles.map((function(e){return e.name})).indexOf(t)&&e.$router.push(e.toURL)}}))},methods:{loginAction:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$alert("信息填写有误，请检查用户名和密码","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/open/loginAdmin",t.loginForm).then((function(e){e&&1==e.code?t.$message({message:"登录成功",type:"success",showClose:!0,onClose:function(){t.$router.push(t.toURL)}}):e.tips&&t.$alert(e.tips,"登录失败",{confirmButtonText:"确定"})}))}))},resetForm:function(e){this.$refs[e].resetFields()}}},Pe=Te,Ae=(a("c4d2"),Object(g["a"])(Pe,$e,ze,!1,null,"56c6cda2",null)),Ne=Ae.exports,Oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home-div"},[a("div",{staticClass:"header-div"},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.userInfo.username,expression:"userInfo.username"}],staticClass:"username",on:{click:e.editProfile}},[a("i",{staticClass:"el-icon-user-solid"}),a("span",{staticClass:"username-span"},[e._v(e._s(e.userInfo.username))])]),a("span",[a("router-link",{staticClass:"alink",attrs:{to:"/"}},[e._v("返回首页")])],1),a("span",{staticClass:"logout-button",on:{click:e.logout}},[a("i",{staticClass:"el-icon-switch-button"}),e._v("退出 ")])]),a("el-menu",{staticClass:"left-menu",attrs:{"unique-opened":"",router:"","default-active":e.$route.path,collapse:e.leftMenu.isCollapse},on:{open:function(t){return e.collapseLeft(!0)},close:function(t){return e.collapseLeft(!1)}}},e._l(e.leftMenu.navList,(function(t){return a(t.children&&t.children.length>0?"el-submenu":"el-menu-item",{key:t.title+t.url,tag:"component",staticClass:"menu-item",attrs:{index:t.url}},[a("template",{slot:"title"},[a("i",{class:[t.icon]}),a("span",[e._v(e._s(t.title))])]),t.children&&t.children.length>0?e._l(t.children,(function(t,o){return a("el-menu-item",{key:t.url+o,staticClass:"menu-item",attrs:{index:t.url}},[a("i",{class:[t.icon]}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])})):e._e()],2)})),1),a("div",{staticClass:"right-part",class:{collapse:e.leftMenu.isCollapse}},[a("div",{staticClass:"article-div"},[a("router-view",{on:{"update-user":e.getUserInfo}})],1)])],1)},De=[];window.axios=r["a"];var Ee={data:function(){return{userInfo:{username:""},leftMenu:{isCollapse:!1,navList:[{icon:"el-icon-suitcase",title:"商家管理",url:"/admin/menu/StoreManage"},{icon:"el-icon-setting",title:"用户管理",url:"/admin/menu/CustomerManage"},{icon:"el-icon-truck",title:"配送员管理",url:"/admin/menu/DeliverManage"},{icon:"el-icon-price-tag",title:"推荐管理",url:"/admin/menu/CommendManage"},{icon:"el-icon-s-promotion",title:"入驻申请",url:"/admin/menu/StoreRequestManage"},{icon:"el-icon-folder-opened",title:"备份还原",url:"/admin/menu/BackupRestore"},{icon:"el-icon-user",title:"个人资料",url:"/admin/menu/PersonProfile"}]}}},mounted:function(){window.$=this.$,this.getUserInfo()},methods:{getUserInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!=t&&t!=this.userInfo.id||r["a"].get("/open/loginStatus").then((function(t){t&&1==t.code&&(e.userInfo=t.data)}))},logout:function(){var e=this;r["a"].get("/logout").then((function(){e.$router.push("/admin/login")}))},collapseLeft:function(){},editProfile:function(){this.$router.push("/admin/menu/PersonProfile")}}},Ve=Ee,je=(a("ab67"),Object(g["a"])(Ve,Oe,De,!1,null,"2316df50",null)),Le=je.exports,Fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"person-profile-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"tab-div"},[a("el-tabs",{staticStyle:{height:"350px"},attrs:{"tab-position":"left"}},[a("el-tab-pane",{attrs:{label:"用户信息"}},[a("el-form",{attrs:{"label-position":"right","label-width":"80px",model:e.userInfo}},[a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"账号 ID:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.id))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"昵称:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.nickname))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"用户名:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.username))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"手机号码:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.phone))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"创建时间:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.createTime))])]),a("el-form-item",{staticClass:"closer-form-item",attrs:{label:"更新时间:"}},[a("span",{staticClass:"field-span"},[e._v(e._s(e.userInfo.updateTime))])])],1)],1),a("el-tab-pane",{attrs:{label:"修改资料"}},[a("el-form",{ref:"userForm",attrs:{"label-position":"right","label-width":"80px",model:e.user,rules:e.rules}},[a("el-form-item",{staticClass:"first-line",attrs:{label:"昵称",prop:"nickname"}},[a("el-input",{attrs:{placeholder:"请输入用户昵称"},model:{value:e.user.nickname,callback:function(t){e.$set(e.user,"nickname",t)},expression:"user.nickname"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{"show-password":"",placeholder:"请输入密码，为空则不更改"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{placeholder:"请输入邮箱作为用户名"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),a("el-form-item",{attrs:{label:"手机号码"}},[a("el-input",{attrs:{placeholder:"请输入11位手机号码"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.editProfile}},[e._v("提交")]),a("el-button",{on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1)],1)],1)])])])},Me=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("个人资料")])])])}],Ue={data:function(){return{userInfo:{createTime:"",username:"",phone:"",id:"",updateTime:"",nickname:""},user:{nickname:"",password:"",username:"",phone:""},rules:{nickname:[{validator:function(e,t,a){t?a():a(new Error("请输入昵称"))},trigger:"blur"}],username:[{validator:function(e,t,a){/\d{11}/.test(t)?a():a(new Error("请输入11位手机号码"))},trigger:"blur"}]}}},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar(),this.getUserInfo()},methods:{getUserInfo:function(){var e=this;r["a"].get("/open/loginStatus").then((function(t){t&&1==t.code&&(e.userInfo=t.data,e.user.nickname=t.data.nickname,e.user.username=t.data.username,e.user.phone=t.data.phone)}))},resetForm:function(){this.$refs["userForm"].resetFields()},editProfile:function(){var e=this,t=JSON.parse(JSON.stringify(this.user));null==t.password&&delete t.password,this.$refs["userForm"].validate((function(a){if(!a)return e.$alert("信息填写有误","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/user/save",Object(l["a"])({id:e.userInfo.id},t)).then((function(t){t&&1==t.code?(e.$message({message:"修改资料成功",type:"success"}),e.resetForm(),e.getUserInfo(),e.$emit("update-user")):e.$alert(t.tips,"修改资料失败",{confirmButtonText:"确定"})}))}))}}},Be=Ue,qe=(a("c62e"),Object(g["a"])(Be,Fe,Me,!1,null,"2897f501",null)),Re=qe.exports,Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"store-manage-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"stores-div"},[a("div",{staticClass:"tools-div"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchInfo}},[a("el-form-item",{attrs:{label:"查找商家:"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入ID/店主ID/店名/描述/地址/手机号","prefix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchInfo()}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getSearchInfo()}}},[e._v("查询")])],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-plus"},on:{click:function(t){e.dialog.addStoreVisble=!0}}},[e._v("添加商家")])],1)],1)],1),a("div",{staticClass:"account-table"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.updateInfo},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"商家列表",name:"menuList"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getTableInfo()}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableInfo.tableData,border:""},on:{"expand-change":e.updateScrollbar}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e._l(e.tableInfo.stringMap,(function(o,i){return a("el-form-item",{key:o.id,attrs:{label:e.tableInfo.stringMap[i]}},[a("span",[e._v(e._s(t.row[i]))])])})),a("el-form-item",{attrs:{label:"店铺图标"}},[a("el-avatar",{attrs:{shape:"square",size:100,fit:"cover",src:t.row["logo"]}})],1)],2)]}}])}),a("el-table-column",{attrs:{label:"商家 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"店名",prop:"storeName"}}),a("el-table-column",{attrs:{label:"店主",prop:"ownerName"}}),a("el-table-column",{attrs:{label:"联系方式",prop:"phone"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"更新时间",prop:"updateTime"}}),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",icon:"el-icon-setting",title:"切换为该商家登录状态并跳转到店铺管理页面",size:"small"},on:{click:function(a){return e.chroot(t.row.id)}}},[e._v("打开")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",title:"编辑商家信息",size:"small"},on:{click:function(a){return e.showEditStore(t.$index)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",title:"删除商家",size:"small"},on:{click:function(a){return e.deleteStore(t.$index)}}},[e._v("删除")])]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.tableInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.tableInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.tableInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changePageSize,"current-change":e.changePage}})],1)]),a("el-tab-pane",{attrs:{label:"搜索结果",name:"searchResult"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getSearchInfo(!0)}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchInfo.tableData,border:""},on:{"expand-change":e.updateScrollbar}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e._l(e.tableInfo.stringMap,(function(o,i){return a("el-form-item",{key:o.id,attrs:{label:e.tableInfo.stringMap[i]}},[a("span",[e._v(e._s(t.row[i]))])])})),a("el-form-item",{attrs:{label:"店铺图标"}},[a("el-avatar",{attrs:{shape:"square",size:100,fit:"cover",src:t.row["logo"]}})],1)],2)]}}])}),a("el-table-column",{attrs:{label:"商家 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"店名",prop:"storeName"}}),a("el-table-column",{attrs:{label:"店主",prop:"ownerName"}}),a("el-table-column",{attrs:{label:"联系方式",prop:"phone"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"更新时间",prop:"updateTime"}}),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",icon:"el-icon-setting",title:"切换为该商家登录状态并跳转到店铺管理页面",size:"small"},on:{click:function(a){return e.chroot(t.row.id)}}},[e._v("打开")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",title:"编辑商家信息",size:"small"},on:{click:function(a){return e.showEditStore(t.$index)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",title:"删除商家",size:"small"},on:{click:function(a){return e.deleteStore(t.$index)}}},[e._v("删除")])]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.searchInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.searchInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.searchInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changeSearchPageSize,"current-change":e.changeSearchPage}})],1)])],1)],1)]),a("el-dialog",{attrs:{title:"添加商家",visible:e.dialog.addStoreVisble,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"addStoreVisble",t)}}},[a("el-form",{ref:"addStoreForm",attrs:{model:e.dialog.newStore,rules:e.dialog.rules}},[a("el-form-item",{attrs:{label:"店主","label-width":"120px"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.dialog.newStore.ownerId,callback:function(t){e.$set(e.dialog.newStore,"ownerId",t)},expression:"dialog.newStore.ownerId"}},e._l(e.userList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"店铺名称","label-width":"120px",prop:"storeName"}},[a("el-input",{attrs:{placeholder:"请输入店铺名称",autocomplete:"off"},model:{value:e.dialog.newStore.storeName,callback:function(t){e.$set(e.dialog.newStore,"storeName",t)},expression:"dialog.newStore.storeName"}})],1),a("el-form-item",{attrs:{label:"店铺地址","label-width":"120px",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入店铺地址",autocomplete:"off"},model:{value:e.dialog.newStore.address,callback:function(t){e.$set(e.dialog.newStore,"address",t)},expression:"dialog.newStore.address"}})],1),a("el-form-item",{attrs:{label:"联系方式","label-width":"120px",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入联系方式",autocomplete:"off"},model:{value:e.dialog.newStore.phone,callback:function(t){e.$set(e.dialog.newStore,"phone",t)},expression:"dialog.newStore.phone"}})],1),a("el-form-item",{attrs:{label:"店铺描述","label-width":"120px",prop:"description"}},[a("el-input",{attrs:{placeholder:"请输入店铺描述",autocomplete:"off"},model:{value:e.dialog.newStore.description,callback:function(t){e.$set(e.dialog.newStore,"description",t)},expression:"dialog.newStore.description"}})],1),a("el-form-item",{attrs:{label:"起送金额","label-width":"120px",prop:"minCost"}},[a("el-input",{attrs:{placeholder:"请输入起送金额>=0",autocomplete:"off"},model:{value:e.dialog.newStore.minCost,callback:function(t){e.$set(e.dialog.newStore,"minCost",t)},expression:"dialog.newStore.minCost"}})],1),a("el-form-item",{attrs:{label:"配送费用","label-width":"120px",prop:"postFee"}},[a("el-input",{attrs:{placeholder:"请输入配送费用>=0",autocomplete:"off"},model:{value:e.dialog.newStore.postFee,callback:function(t){e.$set(e.dialog.newStore,"postFee",t)},expression:"dialog.newStore.postFee"}})],1),a("el-form-item",{attrs:{label:"店铺图标","label-width":"120px"}},[a("el-upload",{staticClass:"upload-image",attrs:{"on-success":e.uploadIconSuccess,action:e.uploadUrl,limit:1,name:"file","list-type":"picture-card","before-upload":e.beforeIconUpload,"on-exceed":e.uploadExcced}},[a("i",{staticClass:"el-icon-plus"})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.addStoreVisble=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addStore()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑商家",visible:e.dialog.editStoreVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"editStoreVisible",t)}}},[a("el-form",{ref:"editStoreForm",attrs:{model:e.dialog.editStore,rules:e.dialog.rules}},[a("el-form-item",{attrs:{label:"店主","label-width":"120px"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.dialog.editStore.ownerId,callback:function(t){e.$set(e.dialog.editStore,"ownerId",t)},expression:"dialog.editStore.ownerId"}},e._l(e.userList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"店铺名称","label-width":"120px",prop:"storeName"}},[a("el-input",{attrs:{placeholder:"请输入店铺名称",autocomplete:"off"},model:{value:e.dialog.editStore.storeName,callback:function(t){e.$set(e.dialog.editStore,"storeName",t)},expression:"dialog.editStore.storeName"}})],1),a("el-form-item",{attrs:{label:"店铺地址","label-width":"120px",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入店铺地址",autocomplete:"off"},model:{value:e.dialog.editStore.address,callback:function(t){e.$set(e.dialog.editStore,"address",t)},expression:"dialog.editStore.address"}})],1),a("el-form-item",{attrs:{label:"联系方式","label-width":"120px",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入联系方式",autocomplete:"off"},model:{value:e.dialog.editStore.phone,callback:function(t){e.$set(e.dialog.editStore,"phone",t)},expression:"dialog.editStore.phone"}})],1),a("el-form-item",{attrs:{label:"店铺描述","label-width":"120px",prop:"description"}},[a("el-input",{attrs:{placeholder:"请输入店铺描述",autocomplete:"off"},model:{value:e.dialog.editStore.description,callback:function(t){e.$set(e.dialog.editStore,"description",t)},expression:"dialog.editStore.description"}})],1),a("el-form-item",{attrs:{label:"起送金额","label-width":"120px",prop:"minCost"}},[a("el-input",{attrs:{placeholder:"请输入起送金额>=0",autocomplete:"off"},model:{value:e.dialog.editStore.minCost,callback:function(t){e.$set(e.dialog.editStore,"minCost",t)},expression:"dialog.editStore.minCost"}})],1),a("el-form-item",{attrs:{label:"配送费用","label-width":"120px",prop:"postFee"}},[a("el-input",{attrs:{placeholder:"请输入配送费用>=0",autocomplete:"off"},model:{value:e.dialog.editStore.postFee,callback:function(t){e.$set(e.dialog.editStore,"postFee",t)},expression:"dialog.editStore.postFee"}})],1),a("el-form-item",{attrs:{label:"店铺图标","label-width":"120px"}},[a("el-upload",{staticClass:"upload-image",attrs:{"on-success":e.editIconSuccess,action:e.uploadUrl,limit:1,name:"file","list-type":"picture-card","before-upload":e.beforeIconUpload,"on-exceed":e.uploadExcced,"file-list":e.dialog.editStore.fileList}},[a("i",{staticClass:"el-icon-plus"})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.editStoreVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editStore()}}},[e._v("确 定")])],1)],1)],1)])])},Qe=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("商家管理")])])])}],Ze={data:function(){var e=function(e,t,a){t?a():a(new Error("不能为空"))},t=function(e,t,a){!(t+"")||t<0?a(new Error("请输入大于等于0的数字")):a()},a={host:window.location.protocol+"//"+window.location.host,uploadUrl:"/store/uploadIcon",userList:[],dialog:{addStoreVisble:!1,editStoreVisible:!1,newStore:{ownerId:"",storeName:"",address:"",phone:"",description:"",minCost:"",postFee:"",logo:""},editStore:{ownerId:"",storeName:"",address:"",phone:"",description:"",minCost:"",postFee:"",logo:""},rules:{ownerName:[{validator:e,trigger:"change"}],storeName:[{validator:e,trigger:"blur"}],address:[{validator:e,trigger:"blur"}],phone:[{validator:e,trigger:"blur"}],description:[{validator:e,trigger:"blur"}],minCost:[{validator:t,trigger:"blur"}],postFee:[{validator:t,trigger:"blur"}]}},activeTab:"menuList",searchInfo:{keyword:"",page_num:1,page_size:8,total_num:1,tableData:[]},keyword:"",tableInfo:{page_num:1,page_size:8,total_num:1,stringMap:{id:"店铺ID",ownerId:"店主ID",storeName:"店铺名称",phone:"联系方式",address:"店铺地址",description:"店铺描述",minCost:"起送金额",postFee:"配送费用",updateTime:"更新时间",createTime:"创建时间"},tableData:[]}};return a},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar(),this.getTableInfo(),this.getUserList()},methods:{updateScrollbar:function(e,t){var a=this;this.$nextTick((function(){0!=t.length&&!0!==e||a.$(".table-div").updateScrollbars(!0)}))},chroot:function(e){var t=this;r["a"].get("/admin/store/chroot",{id:e}).then((function(e){e&&1==e.code&&t.$router.push("/store/menu")}))},getUserList:function(){var e=this;r["a"].get("/admin/user/findAll").then((function(t){t&&1==t.code&&t.data instanceof Array&&(t.data.forEach((function(e){var t=e.nickname||e.username;e.label="ID:".concat(e.id," 姓名:").concat(t," 电话:").concat(e.phone),e.value=e.id})),e.userList=t.data)}))},uploadExcced:function(){this.$message({message:"仅支持单个图片上传，点击删除原图片后重新选择",type:"warning"})},beforeIconUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传图片大小不能超过 2MB!"),t},uploadIconSuccess:function(e){e&&1==e.code&&(this.dialog.newStore.logo=e.data)},editIconSuccess:function(e){e&&1==e.code&&(this.dialog.editStore.logo=e.data)},changeSearchPage:function(e){this.searchInfo.page_num=e,this.getSearchInfo(!0)},changeSearchPageSize:function(e){this.searchInfo.page_size=e,this.getSearchInfo(!0)},changePage:function(e){this.tableInfo.page_num=e,this.getTableInfo()},changePageSize:function(e){this.tableInfo.page_size=e,this.getTableInfo()},updateInfo:function(){"menuList"==this.activeTab?this.getTableInfo():this.getSearchInfo(!0)},getTableInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=t?this.searchInfo:this.tableInfo,o={};t&&(o={keyword:this.searchInfo.keyword}),r["a"].get("/admin/store/list",Object(l["a"])({page_num:a.page_num,page_size:a.page_size},o)).then((function(a){a&&1==a.code&&a.data&&(a.data&&a.data.tableData instanceof Array&&a.data.tableData.forEach((function(e){var t=a.data.userMap[e.ownerId];e.ownerName=t.nickname||t.username})),t?e.searchInfo=Object.assign(e.searchInfo,a.data):e.tableInfo=Object.assign(e.tableInfo,a.data))}))},getSearchInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e||(this.searchInfo.keyword=this.keyword),this.activeTab="searchResult",this.getTableInfo(!0)},showaddStore:function(){this.dialog.addStoreVisble=!0},showEditStore:function(e){var t="menuList"==this.activeTab?this.tableInfo:this.searchInfo,a=t.tableData[e];this.dialog.editStore=Object(l["a"])(Object(l["a"])({},a),{},{fileList:[{name:a.logo.split("/").pop(),url:a.logo}]}),this.dialog.editStoreVisible=!0,console.log(this.dialog.editStore)},addStore:function(){this.dialog.addStoreVisble=!1,this.editStore(!0)},editStore:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t||(this.dialog.editStoreVisible=!1);var a=t?this.dialog.newStore:this.dialog.editStore,o=t?"添加":"编辑",i=t?this.$refs["addStoreForm"]:this.$refs["editStoreForm"],s=Object(l["a"])({},a);delete s.updateTime,delete s.createTime,i.validate((function(a){if(!a)return e.$alert("信息填写有误","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/admin/store/save",s).then((function(a){a&&1==a.code?(e.$message({message:o+"商家成功",type:"success"}),t&&i.resetFields(),e.updateInfo()):e.$alert(a.tips,o+"商家失败",{confirmButtonText:"确定"})}))}))},deleteStore:function(e){var t=this,a="menuList"==this.activeTab?this.tableInfo:this.searchInfo,o=a.tableData[e].id;this.$confirm("此操作将永久删除该商家, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r["a"].post("/admin/store/delete",{id:o}).then((function(e){e&&1==e.code?(t.$message({message:"删除商家成功",type:"success"}),t.updateInfo()):t.$alert(e.tips,"删除商家失败",{confirmButtonText:"确定"})}))}))["catch"]((function(){t.$message({type:"info",message:"已取消删除"})}))}}},We=Ze,He=(a("8e43"),Object(g["a"])(We,Je,Qe,!1,null,"77271e9f",null)),Ke=He.exports,Ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"account-manage-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"accounts-div"},[a("div",{staticClass:"tools-div"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchInfo}},[a("el-form-item",{attrs:{label:"查找用户:"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入关键字","prefix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchInfo()}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getSearchInfo()}}},[e._v("查询")])],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-plus"},on:{click:function(t){e.dialog.addAccountVisible=!0}}},[e._v("添加用户")])],1)],1)],1),a("div",{staticClass:"account-table"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.updateInfo},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"用户列表",name:"menuList"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getTableInfo()}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableInfo.tableData,border:""}},[a("el-table-column",{attrs:{label:"用户 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"用户名",prop:"username"}}),a("el-table-column",{attrs:{label:"昵称",prop:"nickname"}}),a("el-table-column",{attrs:{label:"手机号码",prop:"phone"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"更新时间",prop:"updateTime"}}),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",title:"编辑",size:"small"},on:{click:function(a){return e.showEditAccount(t.$index)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",title:"删除用户",size:"small"},on:{click:function(a){return e.deleteAccount(t.$index)}}})]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.tableInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.tableInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.tableInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changePageSize,"current-change":e.changePage}})],1)]),a("el-tab-pane",{attrs:{label:"搜索结果",name:"searchResult"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getSearchInfo(!0)}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchInfo.tableData,border:""}},[a("el-table-column",{attrs:{label:"用户 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"用户名",prop:"username"}}),a("el-table-column",{attrs:{label:"昵称",prop:"nickname"}}),a("el-table-column",{attrs:{label:"手机号码",prop:"phone"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"更新时间",prop:"updateTime"}}),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",title:"编辑",size:"small"},on:{click:function(a){return e.showEditAccount(t.$index)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",title:"删除用户",size:"small"},on:{click:function(a){return e.deleteAccount(t.$index)}}})]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.searchInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.searchInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.searchInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changeSearchPageSize,"current-change":e.changeSearchPage}})],1)])],1)],1)]),a("el-dialog",{attrs:{title:"添加用户",visible:e.dialog.addAccountVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"addAccountVisible",t)}}},[a("el-form",{ref:"addAccountForm",attrs:{model:e.dialog.newAccount,rules:e.dialog.rules}},[a("el-form-item",{attrs:{label:"用户名","label-width":"120px",prop:"username"}},[a("el-input",{attrs:{placeholder:"请输入昵称",autocomplete:"off"},model:{value:e.dialog.newAccount.username,callback:function(t){e.$set(e.dialog.newAccount,"username",t)},expression:"dialog.newAccount.username"}})],1),a("el-form-item",{attrs:{label:"昵称","label-width":"120px",prop:"nickname"}},[a("el-input",{attrs:{placeholder:"请输入昵称",autocomplete:"off"},model:{value:e.dialog.newAccount.nickname,callback:function(t){e.$set(e.dialog.newAccount,"nickname",t)},expression:"dialog.newAccount.nickname"}})],1),a("el-form-item",{attrs:{label:"手机号码","label-width":"120px",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入手机号码",autocomplete:"off"},model:{value:e.dialog.newAccount.phone,callback:function(t){e.$set(e.dialog.newAccount,"phone",t)},expression:"dialog.newAccount.phone"}})],1),a("el-form-item",{attrs:{label:"密码","label-width":"120px",prop:"password"}},[a("el-input",{attrs:{"show-password":"",placeholder:"请输入密码",autocomplete:"off"},model:{value:e.dialog.newAccount.password,callback:function(t){e.$set(e.dialog.newAccount,"password",t)},expression:"dialog.newAccount.password"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.addAccountVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addAccount()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑用户",visible:e.dialog.editAccountVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"editAccountVisible",t)}}},[a("el-form",{ref:"editAccountForm",attrs:{model:e.dialog.account,rules:e.dialog.rules}},[a("el-form-item",{attrs:{label:"用户名","label-width":"120px",prop:"username"}},[a("el-input",{attrs:{placeholder:"请输入昵称",autocomplete:"off"},model:{value:e.dialog.account.username,callback:function(t){e.$set(e.dialog.account,"username",t)},expression:"dialog.account.username"}})],1),a("el-form-item",{attrs:{label:"昵称","label-width":"120px",prop:"nickname"}},[a("el-input",{attrs:{placeholder:"请输入昵称",autocomplete:"off"},model:{value:e.dialog.account.nickname,callback:function(t){e.$set(e.dialog.account,"nickname",t)},expression:"dialog.account.nickname"}})],1),a("el-form-item",{attrs:{label:"手机号码","label-width":"120px",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入手机号码",autocomplete:"off"},model:{value:e.dialog.account.phone,callback:function(t){e.$set(e.dialog.account,"phone",t)},expression:"dialog.account.phone"}})],1),a("el-form-item",{attrs:{label:"密码","label-width":"120px"}},[a("el-input",{attrs:{"show-password":"",placeholder:"请输入密码，为空则不更改",autocomplete:"off"},model:{value:e.dialog.account.password,callback:function(t){e.$set(e.dialog.account,"password",t)},expression:"dialog.account.password"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.editAccountVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editAccount()}}},[e._v("确 定")])],1)],1)],1)])])},Xe=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("用户管理")])])])}],Ye={data:function(){var e=function(e,t,a){t?a():a(new Error("不能为空"))},t={dialog:{addAccountVisible:!1,editAccountVisible:!1,newAccount:{username:"",nickname:"",phone:"",password:""},account:{id:"",nickname:"",username:"",phone:"",password:""},rules:{username:[{validator:e,trigger:"blur"}],nickname:[{validator:e,trigger:"blur"}],password:[{validator:e,trigger:"blur"}],phone:[{validator:e,trigger:"blur"}]}},activeTab:"menuList",searchInfo:{keyword:"",page_num:1,page_size:8,total_num:1,tableData:[]},keyword:"",tableInfo:{page_num:1,page_size:8,total_num:1,tableData:[]}};return t},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar(),this.getTableInfo()},methods:{updateScrollbar:function(e,t){var a=this;this.$nextTick((function(){0!=t.length&&!0!==e||a.$(".table-div").updateScrollbars(!0)}))},changeSearchPage:function(e){this.searchInfo.page_num=e,this.getSearchInfo(!0)},changeSearchPageSize:function(e){this.searchInfo.page_size=e,this.getSearchInfo(!0)},changePage:function(e){this.tableInfo.page_num=e,this.getTableInfo()},changePageSize:function(e){this.tableInfo.page_size=e,this.getTableInfo()},updateInfo:function(){var e,t=this;e="menuList"==this.activeTab?this.getTableInfo():this.getSearchInfo(!0),e.then((function(){t.updateScrollbar([],!0)}))},getTableInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=t?this.searchInfo:this.tableInfo,o={};return t&&(o={keyword:this.searchInfo.keyword}),r["a"].get("/admin/user/list",Object(l["a"])({page_num:a.page_num,page_size:a.page_size},o)).then((function(a){a&&1==a.code&&a.data&&(t?e.searchInfo=Object.assign(e.searchInfo,a.data):e.tableInfo=Object.assign(e.tableInfo,a.data))}))},getSearchInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e||(this.searchInfo.keyword=this.keyword),this.activeTab="searchResult",this.getTableInfo(!0)},showAddAccount:function(){this.dialog.addAccountVisible=!0},showEditAccount:function(e){var t="menuList"==this.activeTab?this.tableInfo:this.searchInfo;this.dialog.account=Object(l["a"])({},t.tableData[e]),this.dialog.editAccountVisible=!0},addAccount:function(){this.dialog.addAccountVisible=!1,this.editAccount(!0)},editAccount:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t||(this.dialog.editAccountVisible=!1);var a=t?this.dialog.newAccount:this.dialog.account,o=t?"添加":"编辑",i=t?this.$refs["addAccountForm"]:this.$refs["editAccountForm"],s=Object(l["a"])({},a);delete s.updateTime,delete s.createTime,delete s.roles,s.password||delete s.password,i.validate((function(a){if(!a)return e.$alert("信息填写有误","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/admin/user/save",s).then((function(a){a&&1==a.code?(e.$message({message:o+"用户成功",type:"success"}),t&&i.resetFields(),e.updateInfo()):e.$alert(a.tips,o+"用户失败",{confirmButtonText:"确定"})}))}))},deleteAccount:function(e){var t=this,a="menuList"==this.activeTab?this.tableInfo:this.searchInfo,o=a.tableData[e].id;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r["a"].post("/admin/user/delete",{id:o}).then((function(e){e&&1==e.code?(t.$message({message:"删除用户成功",type:"success"}),t.updateInfo()):t.$alert(e.tips,"删除用户失败",{confirmButtonText:"确定"})}))}))["catch"]((function(){t.$message({type:"info",message:"已取消删除"})}))}}},et=Ye,tt=(a("118b"),Object(g["a"])(et,Ge,Xe,!1,null,"0c27cbc0",null)),at=tt.exports,ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"account-manage-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"accounts-div"},[a("div",{staticClass:"tools-div"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchInfo}},[a("el-form-item",{attrs:{label:"查找配送员:"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入关键字","prefix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchInfo()}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getSearchInfo()}}},[e._v("查询")])],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-plus"},on:{click:function(t){e.dialog.addAccountVisible=!0}}},[e._v("添加配送员")])],1)],1)],1),a("div",{staticClass:"account-table"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.updateInfo},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"配送员列表",name:"menuList"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getTableInfo()}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableInfo.tableData,border:""}},[a("el-table-column",{attrs:{label:"配送员 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"用户名",prop:"username"}}),a("el-table-column",{attrs:{label:"昵称",prop:"nickname"}}),a("el-table-column",{attrs:{label:"手机号码",prop:"phone"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",title:"编辑",size:"small"},on:{click:function(a){return e.showEditAccount(t.$index)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",title:"删除配送员",size:"small"},on:{click:function(a){return e.deleteAccount(t.$index)}}})]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.tableInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.tableInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.tableInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changePageSize,"current-change":e.changePage}})],1)]),a("el-tab-pane",{attrs:{label:"搜索结果",name:"searchResult"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getSearchInfo(!0)}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchInfo.tableData,border:""}},[a("el-table-column",{attrs:{label:"配送员 ID",prop:"id"}}),a("el-table-column",{attrs:{label:"用户名",prop:"username"}}),a("el-table-column",{attrs:{label:"昵称",prop:"nickname"}}),a("el-table-column",{attrs:{label:"手机号码",prop:"phone"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",title:"编辑",size:"small"},on:{click:function(a){return e.showEditAccount(t.$index)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",title:"删除配送员",size:"small"},on:{click:function(a){return e.deleteAccount(t.$index)}}})]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.searchInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.searchInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.searchInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changeSearchPageSize,"current-change":e.changeSearchPage}})],1)])],1)],1)]),a("el-dialog",{attrs:{title:"添加配送员",visible:e.dialog.addAccountVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"addAccountVisible",t)}}},[a("el-form",{ref:"addAccountForm",attrs:{model:e.dialog.newAccount,rules:e.dialog.rules}},[a("el-form-item",{attrs:{label:"指定用户为配送员","label-width":"140px"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.dialog.newAccount.userId,callback:function(t){e.$set(e.dialog.newAccount,"userId",t)},expression:"dialog.newAccount.userId"}},e._l(e.userList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"为指定的店铺配送","label-width":"140px"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{multiple:"",filterable:"",placeholder:"请选择"},model:{value:e.dialog.newAccount.storeIds,callback:function(t){e.$set(e.dialog.newAccount,"storeIds",t)},expression:"dialog.newAccount.storeIds"}},e._l(e.storeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.addAccountVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addAccount()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑配送员",visible:e.dialog.editAccountVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"editAccountVisible",t)}}},[a("el-form",{ref:"editAccountForm",attrs:{model:e.dialog.account,rules:e.dialog.rules}},[a("el-form-item",{attrs:{label:"指定用户为配送员","label-width":"140px"}},[a("el-select",{attrs:{disabled:"",placeholder:"请选择"},model:{value:e.dialog.account.userId,callback:function(t){e.$set(e.dialog.account,"userId",t)},expression:"dialog.account.userId"}},e._l(e.userList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"为指定的店铺配送","label-width":"140px"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{multiple:"",filterable:"",placeholder:"请选择"},model:{value:e.dialog.account.storeIds,callback:function(t){e.$set(e.dialog.account,"storeIds",t)},expression:"dialog.account.storeIds"}},e._l(e.storeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.editAccountVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editAccount()}}},[e._v("确 定")])],1)],1)],1)])])},it=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("配送员管理")])])])}],st=(a("08d5"),{data:function(){var e={userList:[],storeList:[],dialog:{addAccountVisible:!1,editAccountVisible:!1,newAccount:{userId:"",storeIds:[]},account:{userId:"",storeIds:[]},rules:{}},activeTab:"menuList",searchInfo:{keyword:"",page_num:1,page_size:8,total_num:1,tableData:[]},keyword:"",tableInfo:{page_num:1,page_size:8,total_num:1,tableData:[]}};return e},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar(),this.getTableInfo(),this.getUserList(),this.getStoreList()},methods:{getStoreList:function(){var e=this;r["a"].get("/admin/store/findAll").then((function(t){t&&1==t.code&&t.data instanceof Array&&(t.data.forEach((function(e){e.label="ID:".concat(e.id," 店名:").concat(e.storeName," 电话:").concat(e.phone),e.value=e.id})),e.storeList=t.data)}))},getUserList:function(){var e=this;r["a"].get("/admin/user/findAll").then((function(t){t&&1==t.code&&t.data instanceof Array&&(t.data.forEach((function(e){var t=e.nickname||e.username;e.label="ID:".concat(e.id," 姓名:").concat(t," 电话:").concat(e.phone),e.value=e.id})),e.userList=t.data)}))},changeSearchPage:function(e){this.searchInfo.page_num=e,this.getSearchInfo(!0)},changeSearchPageSize:function(e){this.searchInfo.page_size=e,this.getSearchInfo(!0)},changePage:function(e){this.tableInfo.page_num=e,this.getTableInfo()},changePageSize:function(e){this.tableInfo.page_size=e,this.getTableInfo()},updateInfo:function(){"menuList"==this.activeTab?this.getTableInfo():this.getSearchInfo(!0)},getTableInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=t?this.searchInfo:this.tableInfo,o={};t&&(o={keyword:this.searchInfo.keyword}),r["a"].get("/admin/delivery/list",Object(l["a"])({page_num:a.page_num,page_size:a.page_size},o)).then((function(a){if(a&&1==a.code&&a.data){if(a.data&&a.data.tableData instanceof Array){var o={};a.data.tableData.forEach((function(e){if(o[e.user.id]){o[e.user.id].storeIds.push(e.store.id);var t=o[e.user.id].ct;e.createTime>t&&(o[e.user.id].ct=e.createTime)}else o[e.user.id]=Object(l["a"])(Object(l["a"])({},e.user),{},{storeIds:[e.store.id],ct:e.createTime})})),console.log(o);var i=[];for(var s in o)i.push(o[s]);i=i.sort((function(e,t){e.ct,t.ct})),a.data.tableData=i}t?e.searchInfo=Object.assign(e.searchInfo,a.data):e.tableInfo=Object.assign(e.tableInfo,a.data)}}))},getSearchInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e||(this.searchInfo.keyword=this.keyword),this.activeTab="searchResult",this.getTableInfo(!0)},showAddAccount:function(){this.dialog.addAccountVisible=!0},showEditAccount:function(e){var t="menuList"==this.activeTab?this.tableInfo:this.searchInfo,a=t.tableData[e];this.dialog.account=Object(l["a"])(Object(l["a"])({},a),{},{userId:a.id}),this.dialog.editAccountVisible=!0},addAccount:function(){this.dialog.addAccountVisible=!1,this.editAccount(!0)},editAccount:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t||(this.dialog.editAccountVisible=!1);var a=t?this.dialog.newAccount:this.dialog.account,o=t?"添加":"编辑",i=t?this.$refs["addAccountForm"]:this.$refs["editAccountForm"],s=a.storeIds||[];if(!s||s.length<=0)this.$alert("请选择配送至少一个商铺","未提交",{confirmButtonText:"确定"});else if(a.userId){var n=JSON.stringify(s.map((function(e){return{storeId:e,userId:a.userId}})));console.log(n,s,a),i.validate((function(a){if(!a)return e.$alert("信息填写有误","未提交",{confirmButtonText:"确定"}),!1;r["a"].post("/admin/delivery/save",n,{headers:{"Content-Type":"application/json;charset=utf-8"}}).then((function(a){a&&1==a.code?(e.$message({message:o+"配送员成功",type:"success"}),t&&i.resetFields(),e.updateInfo()):e.$alert(a.tips,o+"配送员失败",{confirmButtonText:"确定"})}))}))}else this.$alert("请选择一个用户作为配送员","未提交",{confirmButtonText:"确定"})},deleteAccount:function(e){var t=this,a="menuList"==this.activeTab?this.tableInfo:this.searchInfo,o=a.tableData[e].id;this.$confirm("此操作将永久删除该配送员, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r["a"].post("/admin/delivery/delete",{userId:o}).then((function(e){e&&1==e.code?(t.$message({message:"删除配送员成功",type:"success"}),t.updateInfo()):t.$alert(e.tips,"删除配送员失败",{confirmButtonText:"确定"})}))}))["catch"]((function(){t.$message({type:"info",message:"已取消删除"})}))}}}),nt=st,lt=(a("0f3a"),Object(g["a"])(nt,ot,it,!1,null,"1672a286",null)),rt=lt.exports,ct=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"product-manage-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"orders-div"},[a("div",{staticClass:"tools-div"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchInfo}},[a("el-form-item",[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入关键字","prefix-icon":"el-icon-search"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getSearchInfo()}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getSearchInfo()}}},[e._v("查询")])],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-plus"},on:{click:function(t){e.dialog.addCategoryVisible=!0}}},[e._v("添加分类")])],1),a("el-form-item",[a("el-button",{attrs:{size:"small",plain:"",type:"success",icon:"el-icon-plus"},on:{click:e.showAddProduct}},[e._v("添加商品")])],1)],1)],1),a("div",{staticClass:"order-table"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.updateInfo},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"菜单列表",name:"menuList"}},[a("div",{staticClass:"category-tags"},e._l(e.tableInfo.categories,(function(t,o){return a("el-tag",{key:t.id,staticClass:"category-tag",attrs:{size:"small",closable:""},on:{click:e.selectCategory,close:function(t){return e.deleteCategory(o)}},nativeOn:{click:function(t){return e.showEditCategory(t,o)}}},[e._v(e._s(t.name)),a("i",{staticClass:"el-icon-edit edit-category"})])})),1),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getTableInfo()}}}),a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableInfo.tableData},on:{"expand-change":e.updateScrollbar}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e._l(e.tableInfo.stringMap,(function(o,i){return a("el-form-item",{key:o.id,attrs:{label:e.tableInfo.stringMap[i]}},[a("span",[e._v(e._s(t.row[i]))])])})),a("el-form-item",{attrs:{label:"商品图片"}},[a("el-avatar",{attrs:{shape:"square",size:100,fit:"cover",src:t.row["productIcon"]}})],1)],2)]}}])}),a("el-table-column",{attrs:{label:"商品 ID",prop:"productId"}}),a("el-table-column",{attrs:{label:"商品名称",prop:"productName"}}),a("el-table-column",{attrs:{label:"价格",prop:"productPrice"}}),a("el-table-column",{attrs:{label:"库存",prop:"productStock"}}),a("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",title:"删除",size:"small"},on:{click:function(a){return e.deleteProduct(t.$index)}}})]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.tableInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.tableInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.tableInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changePageSize,"current-change":e.changePage}})],1)]),a("el-tab-pane",{attrs:{label:"搜索结果",name:"searchResult"}},[a("i",{staticClass:"el-icon-refresh refresh-table",on:{click:function(t){return e.getSearchInfo(!0)}}}),a("div",{staticClass:"table-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"inline-block"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchInfo.tableData},on:{"expand-change":e.updateScrollbar}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e._l(e.tableInfo.stringMap,(function(o,i){return a("el-form-item",{key:o.id,attrs:{label:e.tableInfo.stringMap[i]}},[a("span",[e._v(e._s(t.row[i]))])])})),a("el-form-item",{attrs:{label:"商品图片"}},[a("el-avatar",{attrs:{shape:"square",size:100,fit:"cover",src:t.row["productIcon"]}})],1)],2)]}}])}),a("el-table-column",{attrs:{label:"商品 ID",prop:"productId"}}),a("el-table-column",{attrs:{label:"商品名称",prop:"productName"}}),a("el-table-column",{attrs:{label:"价格",prop:"productPrice"}}),a("el-table-column",{attrs:{label:"库存",prop:"productStock"}}),a("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",title:"删除",size:"small"},on:{click:function(a){return e.deleteProduct(t.$index)}}})]}}])})],1)],1)]),a("div",{staticClass:"pager-div"},[a("el-pagination",{attrs:{"current-page":e.searchInfo.page_num,"page-sizes":[6,8,10,15,20,30],"page-size":e.searchInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.searchInfo.total_num,"pager-count":5,size:"small"},on:{"size-change":e.changeSearchPageSize,"current-change":e.changeSearchPage}})],1)])],1)],1)]),a("el-dialog",{attrs:{title:"添加分类",visible:e.dialog.addCategoryVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"addCategoryVisible",t)}}},[a("el-form",{attrs:{model:e.dialog.newCategory}},[a("el-form-item",{attrs:{label:"分类名称","label-width":"120px"}},[a("el-input",{attrs:{autocomplete:"off"},nativeOn:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.dialogFormVisible=!1,e.addCategory()}},model:{value:e.dialog.newCategory.categoryName,callback:function(t){e.$set(e.dialog.newCategory,"categoryName",t)},expression:"dialog.newCategory.categoryName"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.addCategoryVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialog.addCategoryVisible=!1,e.addCategory()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑分类",visible:e.dialog.editCategoryVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"editCategoryVisible",t)}}},[a("el-form",{attrs:{model:e.dialog.editCategory}},[a("el-form-item",{attrs:{label:"分类名称","label-width":"120px"}},[a("el-input",{attrs:{disabled:""},model:{value:e.dialog.editCategory.oldName,callback:function(t){e.$set(e.dialog.editCategory,"oldName",t)},expression:"dialog.editCategory.oldName"}})],1),a("el-form-item",{attrs:{label:"编辑名称","label-width":"120px"}},[a("el-input",{attrs:{placeholder:"请输入名称",autocomplete:"off"},nativeOn:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.editCategoryVisible=!1,e.editCategory()}},model:{value:e.dialog.editCategory.categoryName,callback:function(t){e.$set(e.dialog.editCategory,"categoryName",t)},expression:"dialog.editCategory.categoryName"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.editCategoryVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialog.editCategoryVisible=!1,e.editCategory()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"添加商品",visible:e.dialog.addProductVisible,"modal-append-to-body":!1,"append-to-body":!0},on:{"update:visible":function(t){return e.$set(e.dialog,"addProductVisible",t)},close:function(t){e.dialog.addProductVisible=!1}}},[a("el-form",{attrs:{model:e.dialog.newProduct,"status-icon":"",rules:e.dialog.rules}},[a("el-form-item",{attrs:{label:"推荐商品","label-width":"120px"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.dialog.newProduct.productId,callback:function(t){e.$set(e.dialog.newProduct,"productId",t)},expression:"dialog.newProduct.productId"}},e._l(e.productList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"分类","label-width":"120px"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.dialog.newProduct.typeId,callback:function(t){e.$set(e.dialog.newProduct,"typeId",t)},expression:"dialog.newProduct.typeId"}},e._l(e.tableInfo.categories,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialog.addProductVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addProduct}},[e._v("确 定")])],1)],1)],1)])])},dt=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("推荐菜单管理")])])])}],ut={data:function(){return{productList:[],dialog:{addCategoryVisible:!1,editCategoryVisible:!1,addProductVisible:!1,editCategoryIndex:-1,newCategory:{categoryName:""},editCategory:{categoryName:"",oldName:""},newProduct:{id:"",typeId:"",productId:""},rules:{},editProduct:{id:"",typeId:"",productId:""}},activeTab:"menuList",categoryTypeMap:{},searchInfo:{keyword:"",page_num:1,page_size:8,total_num:1,tableData:[]},keyword:"",tableInfo:{page_num:1,page_size:8,total_num:1,categories:[],stringMap:{productId:"商品ID",productName:"商品名称",categoryName:"分类",productDescription:"描述",productPrice:"价格",productStock:"库存",updateTime:"更新时间",createTime:"创建时间"},tableData:[]}}},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar(),this.getTableInfo(),this.getProductList()},methods:{getProductList:function(){var e=this;r["a"].get("/admin/product/findAll").then((function(t){t&&1==t.code&&t.data instanceof Array&&(t.data.forEach((function(e){e.label="ID:".concat(e.id," 名称:").concat(e.productName," 价格:").concat(e.price),e.value=e.id})),e.productList=t.data)}))},updateScrollbar:function(e,t){var a=this;this.$nextTick((function(){0!=t.length&&!0!==e||a.$(".table-div").updateScrollbars(!0)}))},changeSearchPage:function(e){this.searchInfo.page_num=e,this.getSearchInfo(!0)},changeSearchPageSize:function(e){this.searchInfo.page_size=e,this.getSearchInfo(!0)},changePage:function(e){this.tableInfo.page_num=e,this.getTableInfo()},changePageSize:function(e){this.tableInfo.page_size=e,this.getTableInfo()},updateInfo:function(){var e,t=this;e="menuList"==this.activeTab?this.getTableInfo():this.getSearchInfo(!0),e.then((function(){t.updateScrollbar([],!0)}))},getTableInfo:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=t?this.searchInfo:this.tableInfo,o={};return t&&(o={keyword:this.searchInfo.keyword}),r["a"].get("/admin/commend/list",Object(l["a"])({page_num:a.page_num,page_size:a.page_size},o)).then((function(a){if(a&&1==a.code&&a.data){var o={};a.data.categories.map((function(e){o[e.id]=e.name})),e.categoryTypeMap=o;var i=["productName","productDescription"];a.data.tableData.forEach((function(e){e.categoryName=o[e.typeId],e.productId=e.product.id,e.productIcon=e.product.imgUrl,e.productPrice=e.product.price,e.productStock=e.product.stock,i.forEach((function(t){e[t]=e.product[t]}))})),console.log(o),t?e.searchInfo=Object.assign(e.searchInfo,a.data):e.tableInfo=Object.assign(e.tableInfo,a.data)}}))},getSearchInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e||(this.searchInfo.keyword=this.keyword,this.searchInfo.productStatus=this.productStatus),this.activeTab="searchResult",this.getTableInfo(!0)},showAddProduct:function(){this.dialog.addProductVisible=!0,this.dialog.newProduct.productStatus=0;try{this.dialog.newProduct.typeId=this.tableInfo.categories[0].id}catch(e){}},addProduct:function(){this.editProduct(!0)},editProduct:function(){var e,t=this,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=a?"添加":"编辑";a?(e=this.dialog.newProduct,this.dialog.addProductVisible=!1):(e=this.dialog.editProduct,this.dialog.editProductVisible=!1),e.productId?e.typeId?r["a"].post("/admin/commend/save",e).then((function(e){if(e&&1==e.code){if(t.$message({message:o+"推荐商品成功",type:"success"}),a)for(var i in t.dialog.newProduct)t.dialog.newProduct[i]="";t.updateInfo()}else t.$alert(e.tips,o+"推荐商品失败",{confirmButtonText:"确定"})})):this.$alert("请选择推荐分类","未提交",{confirmButtonText:"确定"}):this.$alert("请选择要推荐的商品","未提交",{confirmButtonText:"确定"})},deleteProduct:function(e){var t=this;this.$confirm("此操作将永久删除该推荐商品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a="menuList"==t.activeTab?t.tableInfo:t.searchInfo,o=a.tableData[e].id;r["a"].post("/admin/commend/delete",{id:o}).then((function(e){e&&1==e.code?(t.$message({message:"删除推荐商品成功",type:"success"}),t.updateInfo(),t.updateScrollbar(!0,[])):t.$alert(e.tips,"删除推荐商品失败",{confirmButtonText:"确定"})}))}))["catch"]((function(){t.$message({type:"info",message:"已取消删除"})}))},showEditCategory:function(e,t){e.target.classList.contains("edit-category")&&(this.dialog.editCategoryIndex=t,this.dialog.editCategoryVisible=!0,this.dialog.editCategory.categoryName=this.dialog.editCategory.oldName=this.tableInfo.categories[t].name)},addCategory:function(){this.editCategory(!0),this.dialog.newCategory.categoryName=""},editCategory:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.dialog.editCategoryVisible=!1,this.dialog.addCategoryVisible=!1;var a=this.dialog.editCategoryIndex,o="",i=this.dialog.editCategory.categoryName,s=t?"添加":"编辑";t?i=this.dialog.newCategory.categoryName:o=this.tableInfo.categories[a].id,r["a"].post("/admin/commend/saveCate",{id:o,name:i}).then((function(t){t&&1==t.code?(e.$message({message:s+"推荐分类成功",type:"success"}),e.updateInfo()):e.$alert(t.tips,s+"推荐分类失败",{confirmButtonText:"确定"})}))},selectCategory:function(){},deleteCategory:function(e){var t=this;this.$confirm("此操作将永久删除该推荐分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=t.tableInfo.categories[e].id;r["a"].post("/admin/commend/deleteCate",{id:a}).then((function(e){e&&1==e.code?(t.$message({message:"删除推荐分类成功",type:"success"}),t.updateInfo()):t.$alert(e.tips,"删除推荐分类失败",{confirmButtonText:"确定"})}))}))["catch"]((function(){t.$message({type:"info",message:"已取消删除"})}))}}},pt=ut,ft=(a("4a63"),Object(g["a"])(pt,ct,dt,!1,null,"35ec84ae",null)),mt=ft.exports,gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fit-parent"},[a("div",{staticClass:"person-profile-div jquery-scrollbar-element scrollbar-macosx"},[a("div",{staticClass:"padding24"},[e._m(0),a("div",{staticClass:"tab-div"},[a("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"备份",name:"backup"}},[a("el-button",{attrs:{icon:"el-icon-download",type:"primary"},on:{click:e.downloadAction}},[e._v("导出备份")]),a("a",{ref:"backup",staticClass:"unvisible",attrs:{href:"/admin/backup",target:"_blank"}})],1),a("el-tab-pane",{attrs:{label:"还原",name:"restore"}},[a("el-form",{ref:"userForm",attrs:{"label-position":"right"}},[a("el-form-item",{staticClass:"first-line",attrs:{label:"选择SQL文件"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"auto-upload":!1,action:e.uploadURL,"on-success":e.uploadSuccess,"file-list":e.fileList}},[a("el-button",{attrs:{icon:"el-icon-upload",size:"small",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传sql文件")])],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.restoreAction}},[e._v("确认还原")])],1)],1)],1)],1)],1)])])])},bt=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-div"},[a("h2",{staticClass:"title-text"},[a("span",[e._v("备份还原")])])])}],ht={data:function(){return{activeTab:"backup",uploadURL:"/admin/uploadAndrestore",fileList:[]}},mounted:function(){this.$(".jquery-scrollbar-element").scrollbar()},methods:{uploadSuccess:function(e){var t="执行恢复";this.fileList=[],e&&1==e.code?this.$message({message:t+"成功",type:"success"}):this.$alert(e.tips,t+"失败",{confirmButtonText:"确定"})},restoreAction:function(){this.$refs.upload.submit()},downloadAction:function(){this.$refs.backup.click()}}},vt=ht,yt=(a("959e"),Object(g["a"])(vt,gt,bt,!1,null,"4de9dc66",null)),It=yt.exports;o["default"].use(i["a"]);var wt=[{path:"/store",component:L,children:[{path:"login",component:R},{path:"menu",component:K,children:[{path:"ProductManage",component:ae},{path:"StoreProfile",component:me},{path:"OrderManage",component:re},{path:"CommendManage",component:Ie},{path:"PersonProfile",component:Se},{path:"",redirect:"ProductManage"}]},{path:"",redirect:"login"}]},{path:"/delivery",component:L,children:[{path:"login",component:function(){return a.e("chunk-ce301f42").then(a.bind(null,"0617"))}},{path:"menu",component:function(){return a.e("chunk-6f24c98f").then(a.bind(null,"23b5"))},children:[{path:"OrderDelivery",component:function(){return a.e("chunk-59617df1").then(a.bind(null,"f793"))}},{path:"DeliverStore",component:function(){return a.e("chunk-a928cb80").then(a.bind(null,"63c7"))}},{path:"PersonProfile",component:function(){return a.e("chunk-ec35c90a").then(a.bind(null,"745d"))}},{path:"",redirect:"OrderDelivery"}]}]},{path:"/admin",component:L,children:[{path:"login",component:Ne},{path:"menu",component:Le,children:[{path:"StoreManage",component:Ke},{path:"CustomerManage",component:at},{path:"DeliverManage",component:rt},{path:"StoreRequestManage",component:function(){return a.e("chunk-5dc3b95d").then(a.bind(null,"8173"))}},{path:"BackupRestore",component:It},{path:"CommendManage",component:mt},{path:"PersonProfile",component:Re},{path:"",redirect:"StoreManage"}]},{path:"",redirect:"login"}]},{path:"/",component:w,children:[{path:"storeDetail",component:O},{path:"",component:$},{path:"personCenter",component:function(){return a.e("chunk-5ab3efac").then(a.bind(null,"9e73"))},children:[{path:"myOrder",component:function(){return a.e("chunk-346b7dc1").then(a.bind(null,"1d3a"))}},{path:"myComment",component:function(){return a.e("chunk-c2bef06c").then(a.bind(null,"651c"))}},,{path:"profile",component:function(){return a.e("chunk-00ccb4d0").then(a.bind(null,"027a"))}},{path:"",redirect:"myOrder"}]}]},{path:"*",redirect:"/"}],kt=new i["a"]({routes:wt});t["a"]=kt},a51f:function(e,t,a){},ab67:function(e,t,a){"use strict";var o=a("2681"),i=a.n(o);i.a},b523:function(e,t,a){"use strict";var o=a("fd24"),i=a.n(o);i.a},bf5d:function(e,t,a){"use strict";var o=a("9954"),i=a.n(o);i.a},c482:function(e,t,a){"use strict";var o=a("8dec"),i=a.n(o);i.a},c4d2:function(e,t,a){"use strict";var o=a("86b2"),i=a.n(o);i.a},c62e:function(e,t,a){"use strict";var o=a("ca7f"),i=a.n(o);i.a},ca7f:function(e,t,a){},d5e3:function(e,t,a){"use strict";var o=a("2204"),i=a.n(o);i.a},d761:function(e,t,a){},dcbb:function(e,t,a){"use strict";var o=a("821e"),i=a.n(o);i.a},e858:function(e,t,a){},e8aa:function(e,t,a){},eac7:function(e,t,a){},f0c3:function(e,t,a){},fbd2:function(e,t,a){"use strict";var o=a("e8aa"),i=a.n(o);i.a},fd24:function(e,t,a){}});
//# sourceMappingURL=app.02e2cd44.js.map